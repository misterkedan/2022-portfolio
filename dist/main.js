(()=>{"use strict";var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=THREE;function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var i=r((function t(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r||(r=p.getTextureSize(n.length));var i=p.createDataTexture(r);return i.needsUpdate=!0,p.FloatPack.pack(n,i.image.data),new e.Uniform(i)}));var o={glsl:"\nvec4 packFloat( float value ) {\n\n\tif ( value == 0.0 ) return vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\tfloat mag = abs( value );\n\t\n\tfloat exponent = floor( log2( mag ) );\n\texponent += float( exp2( exponent ) <= mag / 2.0 );\n\texponent -= float( exp2( exponent ) > mag );\n\n\tfloat mantissa = ( exponent > 100.0 )\n\t\t? mag / 1024.0 / exp2( exponent - 10.0 ) - 1.0\n\t\t: mag / float( exp2( exponent ) ) - 1.0;\n\n\tfloat r = exponent + 127.0;\n\tmantissa *= 256.0;\n\n\tfloat g = floor( mantissa );\n\tmantissa -= g;\n\tmantissa *= 256.0;\n\n\tfloat b = floor( mantissa );\n\tmantissa -= b;\n\tmantissa *= 128.0;\n\n\tfloat a = floor( mantissa ) * 2.0 + float( value < 0.0 );\n\n\treturn vec4( r, g, b, a ) / 255.0;\n\n}\n\nfloat unpackFloat( vec4 value ) {\n\n\tfloat r = floor( value.r * 255.0 + 0.5 );\n\tfloat g = floor( value.g * 255.0 + 0.5 );\n\tfloat b = floor( value.b * 255.0 + 0.5 );\n\tfloat a = floor( value.a * 255.0 + 0.5 );\n\n\tfloat exponent = r - 127.0;\n\tfloat sign = 1.0 - mod( a, 2.0 ) * 2.0;\n\tfloat mantissa = float( r > 0.0 ) + g / 256.0 + b / 65536.0\n\t\t+ floor( a / 2.0 ) / 8388608.0;\n\treturn sign * mantissa * exp2( exponent );\n\n}",pack:function(t,e){var n,r,i,o,s,a,l;e||(e=new Uint8Array(4*t.length));for(var u=0,c=0,f=t.length;u<f;u++)0!==(n=t[u])&&(r=Math.abs(n),i=Math.floor(Math.log2(r)),i+=(o=Math.pow(2,i))<=r/2,s=(i-=o>r)>100?r/1024/Math.pow(2,i-10)-1:r/o-1,e[c]=i+127,s*=256,a=Math.floor(s),e[c+1]=a,s=256*(s-a),l=Math.floor(s),e[c+2]=l,s=128*(s-l),e[c+3]=2*Math.floor(s)+(n<0)),c+=4;return e},unpack:function(t,e){var n,r,i,o,s,a;e||(e=new Float32Array(t.length/4));for(var l=0,u=0,c=t.length;l<c;l+=4)n=t[l],r=t[l+1],i=t[l+2],s=n-127,a=(1-(o=t[l+3])%2*2)*((n>0)+r/256+i/65536+Math.floor(o/2)/8388608)*Math.pow(2,s),e[u]=a,u++}};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.data,i=n.defaultValue,o=n.textureSize,a=n.length,l=void 0===a?65536:a,u=n.name,c=void 0===u?"data":u,f=n.prefix,h=void 0===f?"GPGPU_":f,d=n.shader,m=void 0===d?t.fragmentShader:d,v=n.uniforms,y=void 0===v?{}:v;if(s(this,t),!p.renderer)throw new Error("Use GPUVariable.init( renderer ) before instancing.");r?l=r.length:o&&(l=o*o),o||(o=p.getTextureSize(l)),this.textureSize=o,this.rt1=p.createRenderTarget(o),this.rt2=p.createRenderTarget(o),this.renderTarget=this.rt1,this.dataTexture=p.createDataTexture(o),this.dataTexture.needsUpdate=!0,r?this.write(r):(r=this.createDataArray(i),i&&this.write(r)),this.output=new e.Uniform(this.dataTexture),this.name=h?h+c:c,this.uniforms=y,this.uniforms[this.name]=this.output,this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:m});var g=o.toFixed(1);this.material.defines.resolution="vec2( ".concat(g,", ").concat(g," )")}var n,r,i;return n=t,(r=[{key:"update",value:function(){this.renderTarget=this.renderTarget===this.rt1?this.rt2:this.rt1,p.render(this.material,this.renderTarget),this.output.value=this.renderTarget.texture}},{key:"dispose",value:function(){this.rt1.dispose(),this.rt2.dispose(),this.dataTexture.dispose(),this.material.dispose()}},{key:"createDataArray",value:function(t){var e=new Float32Array(this.textureSize*this.textureSize);return t&&e.fill(t),e}},{key:"read",value:function(){p.renderer.readRenderTargetPixels(this.renderTarget,0,0,this.textureSize,this.textureSize,this.buffer);var t=this.createDataArray();return o.unpack(this.buffer,t),t}},{key:"write",value:function(t){o.pack(t,this.buffer)}},{key:"buffer",get:function(){return this.dataTexture.image.data}}])&&a(n.prototype,r),i&&a(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}l.vertexShader="\n    void main() {\n\n        gl_Position = vec4( position, 1.0 );\n\n    }\n",l.fragmentShader="\n    uniform sampler2D GPGPU_data;\n\n    ".concat(o.glsl,"\n\n    void main() {\n        \n        vec2 uv = gl_FragCoord.xy / resolution.xy;\n        float data = unpackFloat( texture2D( GPGPU_data, uv ) );\n\n        // Modify data...\n\n        gl_FragColor = packFloat( data );\n\n    }\n");var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._textureSize=t.getTextureSize(e),this.variables={}}var e,n,r;return e=t,(n=[{key:"addVariable",value:function(t,e){var n=new l(c(c({},e),{},{name:t,textureSize:this._textureSize}));this.variables[t]=n,this[t]=n.output}},{key:"addConstant",value:function(t,e){this[t]=new i(e,this._textureSize)}},{key:"assign",value:function(t,e){var n=this.variables[t],r=this.variables[e];n.uniforms[r.name]=r.output}},{key:"tick",value:function(){Object.values(this.variables).forEach((function(t){return t.update()}))}},{key:"textureSize",get:function(){return this._textureSize}}])&&h(e.prototype,n),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}p.init=function(t){if(!p.renderer){p.renderer=t;p.isSupported=!0,p.renderer.capabilities.maxVertexTextures||(console.warn("No support for vertex textures."),p.isSupported=!1),p.isSupported||window.alert("Incompatible hardware."),p.isSupported&&(p.renderer=t,p.scene=new e.Scene,p.camera=new e.Camera,p.mesh=new e.Mesh(new e.PlaneGeometry(2,2)),p.scene.add(p.mesh))}},p.getTextureSize=function(t){if(isNaN(t)||!isFinite(t)||!Number.isInteger(t)||t<1)throw new RangeError("Parameter must be an int > 0 ");for(var e=1,n=2;n*n<t;)n=Math.pow(2,e),e++;return n},p.createDataTexture=function(t){return new e.DataTexture(new Uint8Array(t*t*4),t,t,e.RGBAFormat,e.UnsignedByteType)},p.createRenderTarget=function(t){return new e.WebGLRenderTarget(t,t,{wrapS:e.ClampToEdgeWrapping,wrapT:e.ClampToEdgeWrapping,minFilter:e.NearestFilter,magFilter:e.NearestFilter,stencilBuffer:!1,depthBuffer:!1,format:e.RGBAFormat,type:e.UnsignedByteType})},p.render=function(t,e){p.mesh.material=t,p.renderer.setRenderTarget(e),p.renderer.render(p.scene,p.camera),p.renderer.setRenderTarget(null)},p.FloatPack=o;var v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;d(this,t),this.callbacks="function"==typeof e?[e]:e,this.fps=n,this.elapsed=0,this._last=0,this._deltaOffset=0,this._isPlaying=!1,this._update=this.update.bind(this)}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.has(t)||this.callbacks.push(t)}},{key:"remove",value:function(t){this.has(t)&&this.callbacks.splice(this.callbacks.indexOf(t),1)}},{key:"has",value:function(t){return this.callbacks.includes(t)}},{key:"reset",value:function(){this.elapsed=0}},{key:"start",value:function(){this._last=this.now,this._deltaOffset=0,this._isPlaying=!0,this.requestFrame()}},{key:"pause",value:function(){this._isPlaying=!1}},{key:"stop",value:function(){this.pause(),this.reset()}},{key:"update",value:function(){if(this.isPlaying){this.requestFrame();var e=Math.min(this.now-this._last,t.maxDelta);if(this._last=this.now,this.elapsed+=e,e>=this._frameDuration)return this.tick(e);this._deltaOffset+=e;var n=this._frameDuration-this._deltaOffset;n<=0&&(this.tick(this._frameDuration),this._deltaOffset=Math.abs(n)%this._frameDuration)}}},{key:"tick",value:function(t){var e=this;this.callbacks.forEach((function(n){return n(t,e.elapsed)}))}},{key:"requestFrame",value:function(){requestAnimationFrame(this._update)}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._frameDuration=t>0?Math.floor(1e3/t):0}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"now",get:function(){return t.time.now()}}])&&m(e.prototype,n),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}v.maxDelta=100,v.time=Date||performance;var b=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.container,i=void 0===r?"sketch":r,o=n.width,s=n.height,a=n.fps,l=n.renderer,u=void 0===l?new e.WebGLRenderer({powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1}):l,c=n.debug,f=n.stats;if(y(this,t),this.renderer=u,this.canvas=u.domElement,this.pixelRatio=Math.min(window.devicePixelRatio,2),"string"==typeof i&&(i=document.getElementById(i)),i||(i=document.body),i.appendChild(this.canvas),i.style.touchAction="none",this.width=o>0?o:void 0,this.height=s>0?s:void 0,this.debug=c,this.fps=c?0:a,this.ticker=new v(this.tick.bind(this),a),f||c){this.stats=new t.Stats,i.appendChild(this.stats.domElement);var h=function(){this.stats.update()}.bind(this);this.ticker.add(h)}}var n,r,i;return n=t,r=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sketch;this.sketch=t,this.resize(),this.sketch.init(),this.onResize=function(){this.needsResize=!0}.bind(this),window.addEventListener("resize",this.onResize),this.tick(0,0),this.ticker.start()}},{key:"dispose",value:function(){this.ticker.stop(),window.removeEventListener("resize",this.onResize),window.removeEventListener("touchstart",this.onTouchStart)}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.height;t||(t=window.innerWidth),e||(e=window.innerHeight),this.renderer.setPixelRatio(this.pixelRatio),this.renderer.setSize(t,e),this.sketch.resize(t,e,this.pixelRatio),this.wide=t>1e3,this.needsResize=!1}},{key:"tick",value:function(t,e){this.needsResize&&this.resize(),this.renderer.clear(),this.sketch.tick(t,e)}}],r&&g(n.prototype,r),i&&g(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();b.Stats=window.Stats;var w={};function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}w.uniforms={tMixA:{value:null},tMixB:{value:null},uCellsX:{value:30},uCellsY:{value:100},uDisplace:{value:.2},uMix:{value:0},uSeed:{value:0}},w.vertexShader="\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\n\t\tvUv = uv;\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t}\n",w.fragmentShader="\nuniform sampler2D tMixA;\nuniform sampler2D tMixB;\nuniform float uCellsX;\nuniform float uCellsY;\nuniform float uDisplace;\nuniform float uMix;\nuniform float uSeed;\nvarying vec2 vUv;\n\nfloat random( float x, float y ) {\n\n    vec2 st = vec2( x, y );\n\n    return fract(\n\t\tsin( dot( st.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453123\n\t);\n\n}\n\nfloat perlin( float i, float j ) {\n\n    i = floor( i );\n    j = fract( j );\n    float k = random( i, uSeed );\n    float l = random( i + 1.0, uSeed );\n\n    return mix( k, l, smoothstep( 0.0, 1.0, j ) );\n\n}\n\nfloat parabola( float x, float power ) {\n\n\treturn pow( 4.0 * x * ( 1.0 - x ), power );\n\n}\n\nvoid main() {\n\n\t// Glitch\n\n\tvec2 cells = vec2( uCellsX, uCellsY );\n\n\tvec2 cellM = vUv * cells;\n\tvec2 cellXS = cellM * 10.000;\n\tvec2 cellS = cellM * 5.000;\n\tvec2 cellL = cellM * 0.5;\n\tvec2 cellXL = cellM * 0.1;\n\n    float bands = perlin( \n\t\tcellM.y + uMix, \n\t\tcellM.y * 0.01\n\t);\n\t\n\tfloat smallBands = perlin( \n\t\tcellL.x + random( cellXL.y, 100000.0 ) * 8.0 + uMix * perlin( cellXL.y, cellXL.y ) * 50.0, \n\t\tcellXL.y * 0.001\n\t) * uMix * 0.5;\n\n\tfloat smallNoise = perlin(\n\t\tcellS.x + random( cellM.y, 10000000.0 ) + uMix * perlin( cellXS.y, cellXS.y ) * 1.0,\n\t\tcellM.y * 0.2\n\t) * uMix * 0.75;\n\n\tfloat glitch = parabola( uMix, 2.0 ) * ( bands - smallBands - smallNoise );\n\n\t// Displacement\n\n\tfloat displacement = parabola( vUv.x, 1.0 ) * glitch * uDisplace; \n\tvec2 displacedUv = vec2( vUv.x + displacement, vUv.y );\n\n\t// Mix\n\n\tvec4 texelA = texture2D( tMixA, displacedUv );\n\tvec4 texelB = texture2D( tMixB, displacedUv );\n\n\tgl_FragColor = mix( texelA, texelB, uMix + displacement );\n\n}\n";var P=function(){function t(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scene=new e.Scene;this.camera=new e.OrthographicCamera(-1,1,1,-1,-1,1),this.geometry=new e.PlaneGeometry(2,2),this.material=new e.ShaderMaterial(w),this.quad=new e.Mesh(this.geometry,this.material),this.scene.add(this.quad),this.sketches=r,this.renderer=n}var n,r,i;return n=t,(r=[{key:"init",value:function(){this.sketches.forEach((function(t){return t.init()})),this.set(this.sketches[0],this.sketches[1])}},{key:"set",value:function(t,e){this.mixA=t,this.mixB=e,this.material.uniforms.tMixA.value=this.mixA.output,this.material.uniforms.tMixB.value=this.mixB.output}},{key:"resize",value:function(t,e,n){this.sketches.forEach((function(r){return r.resize(t,e,n)}));var r=t/e,i=Math.ceil(18*r);this.material.uniforms.uCellsX.value=i;var o=.2/r;this.material.uniforms.uDisplace.value=o}},{key:"tick",value:function(t){var e=this.mixA,n=this.mixB,r=this.mix;r>0&&r<1?(t*=2,this.lastTicked=this.lastTicked===e?n:e):this.lastTicked=0===r?e:n,this.lastTicked.tick(t),this.renderer.render(this.scene,this.camera)}},{key:"mix",get:function(){return this.material.uniforms.uMix.value},set:function(t){var e,n,r,i;this.material.uniforms.uMix.value=t,null===(e=(n=this.mixA).out)||void 0===e||e.call(n,t),null===(r=(i=this.mixB).in)||void 0===r||r.call(i,t)}}])&&x(n.prototype,r),i&&x(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i||(i=r),this.camera=n,this.near=r,this.far=i,this.depth=Math.abs(i-r),this.x=new e.Vector3,this.y=new e.Vector3,this.z=new e.Vector3}var n,r,i;return n=t,(r=[{key:"update",value:function(){var t=this.getVisibleHeight(this.far),e=t*this.camera.aspect;this.height=t,this.width=e,this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t,this.x.set(this.left,this.right,this.width),this.y.set(this.bottom,this.top,this.height),this.z.set(this.far,this.near,this.depth),this.needsUpdate=!1}},{key:"getVisibleHeight",value:function(e){return t.getVisibleHeight(this.camera,e)}},{key:"getVisibleWidth",value:function(e){return t.getVisibleWidth(this.camera,e)}}])&&k(n.prototype,r),i&&k(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();O.getVisibleHeight=function(t,e){var n=t.position.z;void 0===e&&(e=n),e+=e<n?-n:n;var r=t.fov*Math.PI/180;return 2*Math.tan(r/2)*Math.abs(e)},O.getVisibleWidth=function(t,e){return O.getVisibleHeight(t,e)*t.aspect};class S{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const C=new e.OrthographicCamera(-1,1,1,-1,0,1),_=new e.BufferGeometry;_.setAttribute("position",new e.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),_.setAttribute("uv",new e.Float32BufferAttribute([0,2,0,0,2,0],2));class T{constructor(t){this._mesh=new e.Mesh(_,t)}dispose(){this._mesh.geometry.dispose()}render(t){t.render(this._mesh,C)}get material(){return this._mesh.material}set material(t){this._mesh.material=t}}var j={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};const E={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new e.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class M extends S{constructor(t,n,r,i){super(),this.strength=void 0!==n?n:1,this.radius=r,this.threshold=i,this.resolution=void 0!==t?new e.Vector2(t.x,t.y):new e.Vector2(256,256),this.clearColor=new e.Color(0,0,0);const o={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new e.WebGLRenderTarget(s,a,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let t=0;t<this.nMips;t++){const n=new e.WebGLRenderTarget(s,a,o);n.texture.name="UnrealBloomPass.h"+t,n.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(n);const r=new e.WebGLRenderTarget(s,a,o);r.texture.name="UnrealBloomPass.v"+t,r.texture.generateMipmaps=!1,this.renderTargetsVertical.push(r),s=Math.round(s/2),a=Math.round(a/2)}void 0===E&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const l=E;this.highPassUniforms=e.UniformsUtils.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new e.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const u=[3,5,7,9,11];s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let t=0;t<this.nMips;t++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(u[t])),this.separableBlurMaterials[t].uniforms.texSize.value=new e.Vector2(s,a),s=Math.round(s/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===j&&console.error("THREE.UnrealBloomPass relies on CopyShader");const c=j;this.copyUniforms=e.UniformsUtils.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:e.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new e.Color,this.oldClearAlpha=1,this.basic=new e.MeshBasicMaterial,this.fsQuad=new T(null)}dispose(){for(let t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(let t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()}setSize(t,n){let r=Math.round(t/2),i=Math.round(n/2);this.renderTargetBright.setSize(r,i);for(let t=0;t<this.nMips;t++)this.renderTargetsHorizontal[t].setSize(r,i),this.renderTargetsVertical[t].setSize(r,i),this.separableBlurMaterials[t].uniforms.texSize.value=new e.Vector2(r,i),r=Math.round(r/2),i=Math.round(i/2)}render(t,e,n,r,i){t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();const o=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),i&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);let s=this.renderTargetBright;for(let e=0;e<this.nMips;e++)this.fsQuad.material=this.separableBlurMaterials[e],this.separableBlurMaterials[e].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[e].uniforms.direction.value=M.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[e]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[e].uniforms.colorTexture.value=this.renderTargetsHorizontal[e].texture,this.separableBlurMaterials[e].uniforms.direction.value=M.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[e]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[e];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(n),this.fsQuad.render(t)),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=o}getSeperableBlurMaterial(t){return new e.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new e.Vector2(.5,.5)},direction:{value:new e.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(t){return new e.ShaderMaterial({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}M.BlurDirectionX=new e.Vector2(1,0),M.BlurDirectionY=new e.Vector2(0,1);const D="vec3 bayerMatrixDither( vec3 color ) {\r\n\r\n\t// Silly code because old devices ( OpenGL ES < 3 ) don't support arrays\r\n\r\n\tint index = int( mod( gl_FragCoord.x - 0.5, 8.0 ) ) + \r\n\t\tint( mod( gl_FragCoord.y - 0.5, 8.0 ) * 8.0 );\r\n\r\n\tfloat dither = 0.0078;\r\n\r\n\tdither = ( index == 1 ) ? 0.0039 : dither;\r\n\tdither = ( index == 2 ) ? 0.0068 : dither;\r\n\tdither = ( index == 3 ) ? 0.0029 : dither;\r\n\tdither = ( index == 4 ) ? 0.0076 : dither;\r\n\tdither = ( index == 5 ) ? 0.0036 : dither;\r\n\tdither = ( index == 6 ) ? 0.0066 : dither;\r\n\tdither = ( index == 7 ) ? 0.0027 : dither;\r\n\r\n\tdither = ( index == 8 )  ? 0.0019 : dither;\r\n\tdither = ( index == 9 )  ? 0.0059 : dither;\r\n\tdither = ( index == 10 ) ? 0.0009 : dither;\r\n\tdither = ( index == 11 ) ? 0.0049 : dither;\r\n\tdither = ( index == 12 ) ? 0.0017 : dither;\r\n\tdither = ( index == 13 ) ? 0.0056 : dither;\r\n\tdither = ( index == 14 ) ? 0.0007 : dither;\r\n\tdither = ( index == 15 ) ? 0.0046 : dither;\r\n\r\n\tdither = ( index == 16 ) ? 0.0063 : dither;\r\n\tdither = ( index == 17 ) ? 0.0024 : dither;\r\n\tdither = ( index == 18 ) ? 0.0073 : dither;\r\n\tdither = ( index == 19 ) ? 0.0034 : dither;\r\n\tdither = ( index == 20 ) ? 0.0061 : dither;\r\n\tdither = ( index == 21 ) ? 0.0022 : dither;\r\n\tdither = ( index == 22 ) ? 0.0071 : dither;\r\n\tdither = ( index == 23 ) ? 0.0032 : dither;\r\n\r\n\tdither = ( index == 24 ) ? 0.0005 : dither;\r\n\tdither = ( index == 25 ) ? 0.0044 : dither;\r\n\tdither = ( index == 26 ) ? 0.0014 : dither;\r\n\tdither = ( index == 27 ) ? 0.0054 : dither;\r\n\tdither = ( index == 28 ) ? 0.0002 : dither;\r\n\tdither = ( index == 29 ) ? 0.0041 : dither;\r\n\tdither = ( index == 30 ) ? 0.0012 : dither;\r\n\tdither = ( index == 31 ) ? 0.0051 : dither;\r\n\r\n\tdither = ( index == 32 ) ? 0.0074 : dither;\r\n\tdither = ( index == 33 ) ? 0.0035 : dither;\r\n\tdither = ( index == 34 ) ? 0.0065 : dither;\r\n\tdither = ( index == 35 ) ? 0.0025 : dither;\r\n\tdither = ( index == 36 ) ? 0.0077 : dither;\r\n\tdither = ( index == 37 ) ? 0.0038 : dither;\r\n\tdither = ( index == 38 ) ? 0.0067 : dither;\r\n\tdither = ( index == 39 ) ? 0.0028 : dither;\r\n\r\n\tdither = ( index == 40 ) ? 0.0016 : dither;\r\n\tdither = ( index == 41 ) ? 0.0055 : dither;\r\n\tdither = ( index == 42 ) ? 0.0006 : dither;\r\n\tdither = ( index == 43 ) ? 0.0045 : dither;\r\n\tdither = ( index == 44 ) ? 0.0018 : dither;\r\n\tdither = ( index == 45 ) ? 0.0057 : dither;\r\n\tdither = ( index == 46 ) ? 0.0008 : dither;\r\n\tdither = ( index == 47 ) ? 0.0047 : dither;\r\n\r\n\tdither = ( index == 48 ) ? 0.006  : dither;\r\n\tdither = ( index == 49 ) ? 0.0021 : dither;\r\n\tdither = ( index == 50 ) ? 0.007  : dither;\r\n\tdither = ( index == 51 ) ? 0.003  : dither;\r\n\tdither = ( index == 52 ) ? 0.0062 : dither;\r\n\tdither = ( index == 53 ) ? 0.0023 : dither;\r\n\tdither = ( index == 54 ) ? 0.0072 : dither;\r\n\tdither = ( index == 55 ) ? 0.0033 : dither;\r\n\r\n\tdither = ( index == 56 ) ? 0.0001 : dither;\r\n\tdither = ( index == 57 ) ? 0.004  : dither;\r\n\tdither = ( index == 58 ) ? 0.0011 : dither;\r\n\tdither = ( index == 59 ) ? 0.005  : dither;\r\n\tdither = ( index == 60 ) ? 0.0003 : dither;\r\n\tdither = ( index == 61 ) ? 0.0043 : dither;\r\n\tdither = ( index == 62 ) ? 0.0013 : dither;\r\n\tdither = ( index == 63 ) ? 0.0052 : dither;\r\n\r\n\treturn color - dither;\r\n\t\r\n}";function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},A(t,e)}function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=F(t);if(e){var i=F(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return G(this,n)}}function G(t,e){if(e&&("object"===z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A(t,e)}(s,t);var n,r,i,o=B(s);function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.strength,r=void 0===n?.6:n,i=t.radius,a=void 0===i?1:i,l=t.threshold,u=void 0===l?.3:l;return R(this,s),o.call(this,new e.Vector2,r,a,u)}return n=s,(r=[{key:"getCompositeMaterial",value:function(t){return new e.ShaderMaterial({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\t".concat(D,"\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 color = bloomStrength * ( \n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv)\n\t\t\t\t\t);\n\n\t\t\t\t\tcolor.rgb = bayerMatrixDither( color.rgb );\n\n\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t}\n\t\t\t")})}}])&&U(n.prototype,r),i&&U(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(M);function X(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math;X(this,t),this.prng=e}var e,n,r;return e=t,n=[{key:"random",value:function(){return this.prng.random()}},{key:"amount",value:function(){return this.random()}},{key:"number",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.random();return isNaN(t)||isNaN(e)?r:n?Math.floor(r*(e-t+1)+t):r*(e-t)+t}},{key:"noise",value:function(){return this.number(-1,1)}},{key:"int",value:function(t,e){return this.number(t,e,!0)}},{key:"uint",value:function(t){return this.int(0,t)}},{key:"boolean",value:function(){return this.random()<.5}},{key:"chance",value:function(t){return this.random()<t}},{key:"item",value:function(t){return t[this.uint(t.length-1)]}},{key:"char",value:function(t){return t.charAt(this.uint(t.length-1))}}],n&&I(e.prototype,n),r&&I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const N="vec3 linearGradient( \r\n\tvec2 origin,\r\n\tvec2 target,\r\n\tvec3 color1,\r\n\tvec3 color2,\r\n\tfloat angle\r\n) {\r\n\r\n\tfloat toTarget = length( target );\r\n\tangle = radians( angle ) + atan( target.y, target.x );\r\n\r\n\tfloat progressX = cos( angle ) * toTarget;\r\n\tfloat progressY = sin( angle ) * toTarget;\r\n\tvec2 progress = vec2( progressX, progressY ) + origin;\r\n\r\n\treturn mix( color1, color2, smoothstep( 0.0, 1.0, progress.x ) );\r\n\t\r\n}";function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){W(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function W(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e){return K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},K(t,e)}function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tt(t);if(e){var i=tt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return J(this,n)}}function J(t,e){if(e&&("object"===V(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},tt(t)}var et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K(t,e)}(s,t);var n,r,i,o=$(s);function s(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.color1,i=void 0===r?16777215:r,a=n.color2,l=void 0===a?0:a,u=n.angle,c=void 0===u?90:u;Q(this,s);var f=new e.PlaneGeometry(2,2),h=new e.ShaderMaterial(Z(Z({},s.shader),{},{uniforms:{uAngle:{value:c},uColor1:{value:new e.Color(i)},uColor2:{value:new e.Color(l)}}}));return(t=o.call(this,f,h)).frustumCulled=!1,t}return n=s,(r=[{key:"angle",get:function(){return this.material.uniforms.uAngle.value},set:function(t){this.material.uniforms.uAngle.value=t}},{key:"color1",get:function(){return this.material.uniforms.uColor1.value},set:function(t){this.material.uniforms.uColor1.value=t}},{key:"color2",get:function(){return this.material.uniforms.uColor2.value},set:function(t){this.material.uniforms.uColor2.value=t}}])&&q(n.prototype,r),i&&q(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.Mesh);et.shader={depthWrite:!1,depthTest:!1,vertexShader:"varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tgl_Position = vec4( position, 1.0 );\r\n\r\n}",fragmentShader:"\n\t\tuniform float uAngle;\n\t\tuniform vec3 uColor1;\n\t\tuniform vec3 uColor2;\n\t\tvarying vec2 vUv;\n\t\t\n\t\t".concat(N,"\n\t\t").concat(D,"\n\n\t\tvoid main() {\n\n\t\t\tvec2 origin = vec2( 0.5, 0.5 );\n\t\t\tvec2 target = vUv - origin;\n\t\t\tvec3 color = linearGradient( origin, target, uColor1, uColor2, uAngle );\n\t\t\t\n\t\t\tcolor = bayerMatrixDither( color );\n\n\t\t\tgl_FragColor = vec4( color, 1.0 );\n\t\t\t\n\t\t}")};class nt extends S{constructor(t,n){super(),this.textureID=void 0!==n?n:"tDiffuse",t instanceof e.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=e.UniformsUtils.clone(t.uniforms),this.material=new e.ShaderMaterial({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new T(this.material)}render(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}}class rt extends S{constructor(t,e){super(),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(t,e,n){const r=t.getContext(),i=t.state;let o,s;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0),this.inverse?(o=0,s=1):(o=1,s=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),i.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),i.buffers.stencil.setClear(s),i.buffers.stencil.setLocked(!0),t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(r.EQUAL,1,4294967295),i.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),i.buffers.stencil.setLocked(!0)}}class it extends S{constructor(){super(),this.needsSwap=!1}render(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}class ot{constructor(t,n){if(this.renderer=t,void 0===n){const r={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat},i=t.getSize(new e.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=i.width,this._height=i.height,(n=new e.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===j&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===nt&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new nt(j),this.clock=new e.Clock}swapBuffers(){const t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}addPass(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(t){const e=this.passes.indexOf(t);-1!==e&&this.passes.splice(e,1)}isLastEnabledPass(t){for(let e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}render(t){void 0===t&&(t=this.clock.getDelta());const e=this.renderer.getRenderTarget();let n=!1;for(let e=0,r=this.passes.length;e<r;e++){const r=this.passes[e];if(!1!==r.enabled){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(e),r.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),r.needsSwap){if(n){const e=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(e.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),n.setFunc(e.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==rt&&(r instanceof rt?n=!0:r instanceof it&&(n=!1))}}this.renderer.setRenderTarget(e)}reset(t){if(void 0===t){const n=this.renderer.getSize(new e.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(t,e){this._width=t,this._height=e;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let t=0;t<this.passes.length;t++)this.passes[t].setSize(n,r)}setPixelRatio(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}new e.OrthographicCamera(-1,1,1,-1,0,1);const st=new e.BufferGeometry;st.setAttribute("position",new e.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),st.setAttribute("uv",new e.Float32BufferAttribute([0,2,0,0,2,0],2));class at extends S{constructor(t,n,r,i,o){super(),this.scene=t,this.camera=n,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=void 0!==o?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new e.Color}render(t,e,n){const r=t.autoClear;let i,o;t.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t.getClearColor(this._oldClearColor),i=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:n),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(this._oldClearColor,i),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),t.autoClear=r}}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.renderer,r=e.stage,i=e.renderToScreen,o=void 0===i||i;lt(this,t),this.composer=new ot(n),this.composer.renderToScreen=o,this.passes={},this.add("render",new at(r.scene,r.camera))}var e,n,r;return e=t,(n=[{key:"add",value:function(t,e){this.passes[t]=e,this.composer.addPass(e)}},{key:"remove",value:function(t){var e,n=this.passes[t];n&&(this.composer.removePass(n),null==n||null===(e=n.dispose)||void 0===e||e.call(n),delete this.passes[t])}},{key:"resize",value:function(t,e,n){this.composer.setSize(t,e),Object.values(this.passes).forEach((function(r){return null==r?void 0:r.setSize(t,e,n)}))}},{key:"tick",value:function(){this.composer.render()}},{key:"dispose",value:function(){Object.values(this.passes).forEach((function(t){var e;return null==t||null===(e=t.dispose)||void 0===e?void 0:e.call(t)})),Object.values(this).forEach((function(t){var e;return null==t||null===(e=t.dispose)||void 0===e?void 0:e.call(t)}))}}])&&ut(e.prototype,n),r&&ut(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.target,r=void 0===n?window:n,i=e.width,o=void 0===i?window.innerWidth:i,s=e.height,a=void 0===s?window.innerHeight:s,l=e.margin,u=void 0===l?0:l,c=e.marginTop,f=e.marginRight,h=e.marginBottom,p=e.marginLeft,d=e.enabled,m=void 0===d||d,v=e.debug,y=void 0!==v&&v,g=e.preventDefault,b=void 0!==g&&g,w=e.onChange;ft(this,t);var x=function(t){return"number"==typeof t&&t>=0?t:u};this.margin={top:x(c),right:x(f),bottom:x(h),left:x(p)},this.hitbox={top:this.margin.top,left:this.margin.left,width:o,height:a},this.resize(o,a),this.x=this.y=.5,this.target=r,this.onMouseMove=function(t){b&&t.preventDefault&&t.preventDefault(),this.track(t.clientX,t.clientY)}.bind(this),this.onTouchMove=function(t){b&&t.preventDefault(),this.onMouseMove(t.targetTouches[0])}.bind(this),this.onChange=w,y&&(this.onDebug=this.log),m&&this.enable()}var e,n,r;return e=t,(n=[{key:"enable",value:function(){this._enabled||(this.target.addEventListener("touchmove",this.onTouchMove),this.target.addEventListener("mousemove",this.onMouseMove),this._enabled=!0)}},{key:"disable",value:function(){this._enabled&&(this.target.removeEventListener("touchmove",this.onTouchMove),this.target.removeEventListener("mousemove",this.onMouseMove),this._enabled=!1)}},{key:"dispose",value:function(){this.disable()}},{key:"track",value:function(t,e){var n,r,i;if(this.clientX!==t){this.clientX=t;var o=this.normalizeX;this.x!==o&&(this.x=o,i=!0)}if(this.clientY!==e){this.clientY=e;var s=this.normalizeY;this.y!==s&&(this.y=s,i=!0)}i&&(null===(n=this.onChange)||void 0===n||n.call(this),null===(r=this.onDebug)||void 0===r||r.call(this))}},{key:"resize",value:function(t,e){var n=this.margin.left*t,r=this.margin.right*t;this.hitbox.width=t-n-r,this.offsetX=n;var i=this.margin.top*e,o=this.margin.bottom*e;this.hitbox.height=e-i-o,this.offsetY=i}},{key:"log",value:function(){var t=this.x,e=this.y,n=this.reverseX,r=this.reverseY,i=this.polarizeX,o=this.polarizeY,s=this.reversePolarizeX,a=this.reversePolarizeY,l=this.centerX,u=this.centerY,c=this.reverseCenterX,f=this.reverseCenterY;console.log({x:t,y:e,reverseX:n,reverseY:r,polarizeX:i,polarizeY:o,reversePolarizeX:s,reversePolarizeY:a,centerX:l,centerY:u,reverseCenterX:c,reverseCenterY:f})}},{key:"normalizeX",get:function(){return t.normalize(this.clientX-this.offsetX,this.hitbox.width)}},{key:"normalizeY",get:function(){return t.normalize(this.clientY-this.offsetY,this.hitbox.height)}},{key:"reverseX",get:function(){return t.reverse(this.x)}},{key:"reverseY",get:function(){return t.reverse(this.y)}},{key:"polarizeX",get:function(){return t.polarize(this.x)}},{key:"polarizeY",get:function(){return t.polarize(this.y)}},{key:"reversePolarizeX",get:function(){return t.reversePolarize(this.x)}},{key:"reversePolarizeY",get:function(){return t.reversePolarize(this.y)}},{key:"centerX",get:function(){return t.center(this.x)}},{key:"centerY",get:function(){return t.center(this.y)}},{key:"reverseCenterX",get:function(){return t.reverseCenter(this.x)}},{key:"reverseCenterY",get:function(){return t.reverseCenter(this.y)}}])&&ht(e.prototype,n),r&&ht(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}pt.clamp=function(t){return t>1?1:t<0?0:t},pt.normalize=function(t,e){return pt.clamp(t/e)},pt.reverse=function(t){return 1-t},pt.polarize=function(t){return 2*t-1},pt.reversePolarize=function(t){return 1-2*t},pt.center=function(t){return 1-2*Math.abs(t-.5)},pt.reverseCenter=function(t){return 2*Math.abs(t-.5)};var vt=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.lookAt,o=void 0===i?{x:0,y:0,z:0}:i,s=r.bounds,a=void 0===s?{x:5,y:5,z:0}:s,l=r.speed,u=void 0===l?.002:l,c=r.intro;dt(this,t),this.camera=n,this.lookAt=new e.Vector3(o.x,o.y,o.z),this.bounds=new e.Vector3(a.x,a.y,a.z),this.speed=u,this.origin=(new e.Vector3).copy(n.position),this.target=new e.Vector3,c&&this.set(c.x,c.y,c.z)}var n,r,i;return n=t,r=[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.camera.position.set(t,e,n),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.target.x=this.origin.x+this.bounds.x*t,this.target.y=this.origin.y+this.bounds.y*e,this.target.z=this.origin.z+this.bounds.z*n,this}},{key:"tick",value:function(t){var n=e.MathUtils.clamp(this.speed*t,0,1);return this.camera.position.lerp(this.target,n),this.camera.lookAt(this.lookAt),this}}],r&&mt(n.prototype,r),i&&mt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();function yt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bt=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.plane,o=r.width,s=void 0===o?1e3:o,a=r.height,l=void 0===a?1e3:a,u=r.horizontal,c=void 0!==u&&u,f=r.cursor,h=r.cursorSize,p=void 0===h?.1:h,d=r.color,m=void 0===d?16711680:d,v=r.opacity,y=void 0===v?.15:v,g=r.lerp,b=r.autoRotate;yt(this,t),i||(i=new e.Mesh(new e.PlaneGeometry(s,l),new e.MeshBasicMaterial({color:m,opacity:y,transparent:y<1})),c&&i.rotateX(-Math.PI/2)),f||(f=new e.Mesh(new e.BoxGeometry(p,p,p),new e.MeshBasicMaterial({color:m}))),n.add(i),n.add(f),this.plane=i,this.cursor=f,this.lerp=g,this.autoRotate=b,this.camera=n.camera,this.tracker=new e.Vector2,this.raycaster=new e.Raycaster,n.debug||(this.plane.visible=!1,this.cursor.visible=!1)}var n,r,i;return n=t,(r=[{key:"set",value:function(t,e){this.tracker.set(t,e)}},{key:"tick",value:function(t){this.autoRotate&&this.plane.quaternion.copy(this.camera.quaternion),this.raycaster.setFromCamera(this.tracker,this.camera);var n=this.raycaster.intersectObject(this.plane)[0];if(null!=n&&n.point){if(!this.lerp)return this.cursor.position.copy(n.point);var r=e.MathUtils.clamp(this.lerp*t,0,1);this.cursor.position.lerp(n.point,r)}}}])&&gt(n.prototype,r),i&&gt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sketch=e,!1!==e.settings.cursorTracker&&this.initTracker(),e.settings.cursorProjector&&this.initProjector(),e.settings.cameraRig&&this.initCameraRig(),e.settings.gui&&this.initGUI()}var e,n,r;return e=t,(n=[{key:"initTracker",value:function(){this.tracker=new pt,this.trackerEnabled=!0}},{key:"initProjector",value:function(){this.projector=new bt(this.sketch,this.sketch.settings.cursorProjector),this.cursor=this.projector.cursor}},{key:"initCameraRig",value:function(){var t=this.sketch.settings,e=t.camera.lookAt,n=t.cameraRig.bounds,r=t.cameraRig.speed,i=t.cameraRig.intro;this.cameraRig=new vt(this.sketch.camera,{lookAt:e,bounds:n,speed:r,intro:i}),this.cameraRigEnabled=!0}},{key:"initGUI",value:function(){this.gui=new t.GUI,this.gui.title(this.sketch.name.toUpperCase()),this.autoCloseGUI()}},{key:"autoCloseGUI",value:function(){this.gui&&(this.sketch.sketchpad.wide||this.gui.close())}},{key:"refreshGUI",value:function(){this.gui&&!this.gui._closed&&this.gui.controllersRecursive().forEach((function(t){return t.updateDisplay()}))}},{key:"resize",value:function(t,e){var n;null===(n=this.tracker)||void 0===n||n.resize(t,e),this.autoCloseGUI()}},{key:"tick",value:function(t){this.cameraRigEnabled&&this.cameraRig.update(this.tracker.reversePolarizeX,this.tracker.y).tick(t)}}])&&wt(e.prototype,n),r&&wt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}xt.GUI=window.GUI,xt.VALUE="value",xt.clamp=e.MathUtils.clamp,xt.lerp=e.MathUtils.lerp;var Ot=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.background,i=n.camera;if(Pt(this,t),this.scene=new e.Scene,r&&(this.scene.background=r),i){if(i instanceof e.Camera==!1){var o=i.start,s=i.lookAt;i=new e.PerspectiveCamera(i.fov,i.aspect,i.near,i.far),o&&i.position.set(o.x,o.y,o.z),s&&i.lookAt(s.x,s.y,s.z)}}else i=new e.PerspectiveCamera;this.camera=i}var n,r,i;return n=t,(r=[{key:"add",value:function(t){this.scene.add(t)}},{key:"remove",value:function(t){this.scene.remove(t)}},{key:"resize",value:function(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}}])&&kt(n.prototype,r),i&&kt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){_t(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Et=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaults,r=void 0===n?{}:n,i=e.settings,o=void 0===i?{}:i,s=e.stage,a=e.background,l=e.random;Tt(this,t),o=Ct(Ct({},r),o),this.settings=o,s||(s=new Ot(o)),this.stage=s;var u=o.sketchpad||new b;this.sketchpad=u,this.effects=new ct({renderer:u.renderer,stage:s,renderToScreen:o.renderToScreen}),this.random=l||o.random?new Y:null,!a&&o.background&&this.initBackground()}var n,r,i;return n=t,r=[{key:"initBackground",value:function(){var t=this.settings.background,n=t instanceof e.Color?t:("string"==typeof t||"number"==typeof t)&&new e.Color(t);if(n)return this.stage.background=n;t.color1&&t.color2&&(this.background=new et(t),this.add(this.background))}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;this.initScene(),t&&(this.controls=new t(this))}},{key:"initScene",value:function(){}},{key:"dispose",value:function(){this.stage.dispose(),this.effects.dispose()}},{key:"resize",value:function(t,e,n){var r,i;this.stage.resize(t,e),null===(r=this.controls)||void 0===r||r.resize(t,e),null===(i=this.effects)||void 0===i||i.resize(t,e,n)}},{key:"tick",value:function(t,e){var n;null===(n=this.controls)||void 0===n||n.tick(t,e),this.effects.tick(t,e)}},{key:"add",value:function(t){this.stage.add(t)}},{key:"remove",value:function(t){this.stage.remove(t)}},{key:"camera",get:function(){return this.stage.camera}},{key:"debug",get:function(){return this.sketchpad.debug}},{key:"name",get:function(){return this.settings.name||"Sketch"}},{key:"output",get:function(){return this.effects.composer.readBuffer.texture}}],r&&jt(n.prototype,r),i&&jt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zt(t,e){return zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},zt(t,e)}function Rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=At(t);if(e){var i=At(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ut(this,n)}}function Ut(t,e){if(e&&("object"===Mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function At(t){return At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},At(t)}var Bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zt(t,e)}(o,t);var e,n,r,i=Rt(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).tracker.x=1,e.orientation=1,e.intensity=.5;var n=t.settings.curl;return e.applyCurlSpeed=function(){t.curlSpeed.value=n.speed/(2*n.epsilon)},e}return e=o,(n=[{key:"tick",value:function(t){if(this.trackerEnabled){var e=xt.clamp,n=xt.lerp,r=this.sketch,i=this.tracker,o=e(r.settings.lerpSpeed*t,0,1);this.orientation=n(this.orientation,i.polarizeX,o),this.intensity=n(this.intensity,i.reverseY,o),r.wind.value.x=.7*this.orientation,r.wind.value.y=n(.2,.5,this.intensity),r.wind.value.z=n(-3.5,3.5,this.intensity),this.sketch.settings.speed=n(6e-4,.0018,this.intensity),r.settings.curl.speed=n(.12,.04,this.intensity),this.applyCurlSpeed()}}}])&&Dt(e.prototype,n),r&&Dt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(xt),Gt={name:"Ablaze",background:{color1:11010090,color2:14505216},colorHigh:13395456,colorLow:16755200,opacity:.9,particle:{count:1e4,size:.04,near:-2,far:-5},disc:{size:.6,segments:64,offset:-1.5,fill:{color:0,opacity:.05,transparent:!0},stroke:{color:13395456,opacity:.1,transparent:!0}},curl:{epsilon:.001,speed:.07,scale:.3,strength:{x:.5,y:.33,z:.5}},rotation:90,scale:{top:0,bottom:1,gradient:.5},GPGPUTextureSize:128,speed:.001,timeFactor:.03,lerpSpeed:.0015,bloom:{strength:.55,radius:.4,threshold:.455},random:!0};const Ft="float loopValue( float value, float minimum, float change ) {\r\n\r\n\treturn minimum + mod( value - minimum, change );\r\n\r\n}",Lt="//\tSimplex 3D Noise \n//\tby Ian McEwan, Ashima Arts\n//\nvec4 permute( vec4 x ){ return mod( ( ( x * 34.0 ) + 1.0 ) * x, 289.0 ); }\nvec4 taylorInvSqrt( vec4 r ){ return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat simplex3D( float vx, float vy, float vz ) {\n\n\tvec3 v = vec3( vx, vy, vz );\n\t\n\tconst vec2 C = vec2( 1.0/6.0, 1.0/3.0   );\n\tconst vec4 D = vec4( 0.0, 0.5, 1.0, 2.0 );\n\n\t// First corner\n\tvec3 i  = floor( v + dot( v, C.yyy ) );\n\tvec3 x0 =   v - i + dot( i, C.xxx ) ;\n\n\t// Other corners\n\tvec3 g = step( x0.yzx, x0.xyz );\n\tvec3 l = 1.0 - g;\n\tvec3 i1 = min(  g.xyz, l.zxy );\n\tvec3 i2 = max(  g.xyz, l.zxy );\n\n\t// x0 = x0 - 0. + 0.0 * C \n\tvec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\tvec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\tvec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n\t// Permutations\n\ti = mod( i, 289.0 ); \n\tvec4 p = permute( permute( permute(\n\t\t\t i.z + vec4( 0.0, i1.z, i2.z, 1.0 ) )\n\t\t   + i.y + vec4( 0.0, i1.y, i2.y, 1.0 ) ) \n\t\t   + i.x + vec4( 0.0, i1.x, i2.x, 1.0 ) );\n\n\t// Gradients\n\t// ( N*N points uniformly over a square, mapped onto an octahedron.)\n  \tfloat n_ = 1.0/7.0; // N=7\n  \tvec3  ns = n_ * D.wyz - D.xzx;\n\n  \tvec4 j = p - 49.0 * floor( p * ns.z *ns.z ); //  mod( p,N*N)\n\n  \tvec4 x_ = floor( j * ns.z );\n  \tvec4 y_ = floor( j - 7.0 * x_ ); // mod( j,N)\n\n  \tvec4 x = x_ *ns.x + ns.yyyy;\n  \tvec4 y = y_ *ns.x + ns.yyyy;\n  \tvec4 h = 1.0 - abs( x ) - abs( y );\n\n  \tvec4 b0 = vec4( x.xy, y.xy );\n  \tvec4 b1 = vec4( x.zw, y.zw );\n\n  \tvec4 s0 = floor( b0 )*2.0 + 1.0;\n  \tvec4 s1 = floor( b1 )*2.0 + 1.0;\n  \tvec4 sh = -step( h, vec4( 0.0 ) );\n\n  \tvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  \tvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  \tvec3 p0 = vec3( a0.xy,h.x );\n  \tvec3 p1 = vec3( a0.zw,h.y );\n  \tvec3 p2 = vec3( a1.xy,h.z );\n  \tvec3 p3 = vec3( a1.zw,h.w );\n\n\t// Normalise gradients\n  \tvec4 norm = taylorInvSqrt( \n\t\tvec4( dot( p0, p0 ), dot( p1, p1 ), dot( p2, p2 ), dot( p3, p3 ) )\n\t);\n  \tp0 *= norm.x;\n  \tp1 *= norm.y;\n  \tp2 *= norm.z;\n  \tp3 *= norm.w;\n\n\t// Mix final noise value\n  \tvec4 m = max( \n\t\t0.6 - vec4( dot( x0, x0 ), dot( x1, x1 ), dot( x2, x2 ), dot( x3, x3 ) ), \n\t\t0.0\n\t);\n  \tm = m * m;\n  \treturn 42.0 * dot( \n\t\tm*m,\n\t\tvec4( dot( p0,x0 ), dot( p1,x1 ), dot( p2,x2 ), dot( p3,x3 ) )\n\t);\n\n}";var Xt={rotateX:"mat3 rotateX( float angle ) {\r\n\treturn mat3(\r\n\t\tvec3(   1.0,\t        0.0,             0.0\t    ),\r\n\t\tvec3(   0.0, \t        cos(angle), \t-sin(angle) ),\r\n\t\tvec3(   0.0, \t        sin(angle), \t cos(angle) )\r\n\t);\r\n}",rotateY:"mat3 rotateY( float angle ) {\r\n\treturn mat3(\r\n\t\tvec3(   cos(angle),    0.0,           sin(angle)  ),\r\n\t\tvec3(   0.0,           1.0,           0.0         ),\r\n\t\tvec3(   -sin(angle),   0.0,           cos(angle)  )\r\n\t);\r\n}",rotateZ:"mat3 rotateZ( float angle ) {\r\n\treturn mat3(\r\n\t\tvec3(   cos(angle),   -sin(angle),     0.0   ),\r\n\t\tvec3(   sin(angle),    cos(angle),     0.0   ),\r\n\t\tvec3(   0.0,           0.0,            1.0   )\r\n\t);\r\n}",scale:"mat3 scale( float x, float y, float z ) {\r\n\treturn mat3(\r\n\t\tvec3(   x,      0.0,    0.0   ),\r\n\t\tvec3(   0.0,    y,      0.0   ),\r\n\t\tvec3(   0.0,    0.0,    z     )\r\n\t);\r\n}",bayerMatrixDither:D,linearGradient:N,loopValue:Ft,simplex3D:Lt,floatPack:o.glsl,getBase:function(){return{blending:e.NormalBlending,transparent:!0}},editBasic:function(t,e,n,r,i){var o="\n",s="#include <common>",a="#include <begin_vertex>",l="#include <logdepthbuf_fragment>";return e&&(t.vertexShader=t.vertexShader.replace(s,s+o+e)),n&&(t.vertexShader=t.vertexShader.replace(a,a+o+n)),r&&(t.fragmentShader=t.fragmentShader.replace(s,s+o+r)),i&&(t.fragmentShader=t.fragmentShader.replace(l,i+o+"\t"+l)),Xt.debug&&(console.log(t.vertexShader),console.log(t.fragmentShader)),t}};const It="\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform float uEpsilon;\nuniform float uCurlScale;\nuniform float uCurlSpeed;\nuniform float uDelta;\nuniform float uTime;\nuniform vec3 uBounds;\nuniform vec3 uCurlStrength;\nuniform vec3 uWind;\n".concat(o.glsl,"\n").concat(Ft,"\n").concat(Lt,"\n\nvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat x = unpackFloat( texture2D( GPGPU_x, uv ) );\n\tfloat y = unpackFloat( texture2D( GPGPU_y, uv ) );\n\tfloat z = unpackFloat( texture2D( GPGPU_z, uv ) );\n\n\t// Curl\n\n\tfloat scaledX = ( x + uTime ) * uCurlScale;\n\tfloat scaledY = ( y + uTime ) * uCurlScale;\n\tfloat scaledZ = ( z + uTime ) * uCurlScale;\n\n\tfloat noiseY1 = simplex3D( scaledX, scaledY + uEpsilon, scaledZ );\n\tfloat noiseY2 = simplex3D( scaledX, scaledY - uEpsilon, scaledZ );\n\tfloat noiseY = noiseY1 - noiseY2;\n\n\tfloat noiseZ1 = simplex3D( scaledX, scaledY, scaledZ + uEpsilon );\n\tfloat noiseZ2 = simplex3D( scaledX, scaledY, scaledZ - uEpsilon );\n\tfloat noiseZ = noiseZ1 - noiseZ2;\n\n\t// epsilon * 2 division applied in uCurlSpeed to save calculations\n\tfloat curl = ( noiseY - noiseZ ) * uCurlSpeed;\n\n\t// Write\n\n\tfloat wind =  uWind.x + simplex3D( uTime, uv.x * 0.1, uv.y * 0.1 );\n\tfloat noise = mix( wind, curl, uCurlStrength.x ) + uWind.x;\n\tx = mix( x, x + noise, uDelta );\n\tx = loopValue( x, uBounds.x, uBounds.z );\n\n\tgl_FragColor = packFloat( x );\n\n}\n"),Yt="\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform float uCurlScale;\nuniform float uCurlSpeed;\nuniform float uDelta;\nuniform float uEpsilon;\nuniform vec3 uBounds;\nuniform vec3 uCurlStrength;\nuniform vec3 uWind;\n".concat(o.glsl,"\n").concat(Ft,"\n").concat(Lt,"\n\nvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat x = unpackFloat( texture2D( GPGPU_x, uv ) );\n\tfloat y = unpackFloat( texture2D( GPGPU_y, uv ) );\n\tfloat z = unpackFloat( texture2D( GPGPU_z, uv ) );\n\n\t// Curl\n\n\tfloat scaledX = x * uCurlScale;\n\tfloat scaledY = y * uCurlScale;\n\tfloat scaledZ = z * uCurlScale;\n\n\tfloat noiseZ1 = simplex3D( scaledX, scaledY, scaledZ + uEpsilon );\n\tfloat noiseZ2 = simplex3D( scaledX, scaledY, scaledZ - uEpsilon );\n\tfloat noiseZ = noiseZ1 - noiseZ2;\n\n\tfloat noiseX1 = simplex3D( scaledX + uEpsilon, scaledY, scaledZ );\n\tfloat noiseX2 = simplex3D( scaledX - uEpsilon, scaledY, scaledZ );\n\tfloat noiseX = noiseX1 - noiseX2;\n\n\tfloat curl = ( noiseZ - noiseX ) * uCurlSpeed;\n\n\t// Write\n\n\tfloat noise = mix( uWind.y, curl, uCurlStrength.y ) + uWind.y;\n\ty = mix( y, y + noise, uDelta );\n\ty = loopValue( y, uBounds.x, uBounds.z );\n\n\tgl_FragColor = packFloat( y );\n\n}\n"),Nt="\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform float uCurlScale;\nuniform float uCurlSpeed;\nuniform float uDelta;\nuniform float uEpsilon;\nuniform vec3 uBounds;\nuniform vec3 uCurlStrength;\nuniform vec3 uWind;\n".concat(o.glsl,"\n").concat(Ft,"\n").concat(Lt,"\n\nvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat x = unpackFloat( texture2D( GPGPU_x, uv ) );\n\tfloat y = unpackFloat( texture2D( GPGPU_y, uv ) );\n\tfloat z = unpackFloat( texture2D( GPGPU_z, uv ) );\n\n\t// Curl\n\n\tfloat scaledX = x * uCurlScale;\n\tfloat scaledY = y * uCurlScale;\n\tfloat scaledZ = z * uCurlScale;\n\n\tfloat noiseX1 = simplex3D( scaledX + uEpsilon, scaledY, scaledZ );\n\tfloat noiseX2 = simplex3D( scaledX - uEpsilon, scaledY, scaledZ );\n\tfloat noiseX = noiseX1 - noiseX2;\n\n\tfloat noiseY1 = simplex3D( scaledX, scaledY + uEpsilon, scaledZ );\n\tfloat noiseY2 = simplex3D( scaledX, scaledY - uEpsilon, scaledZ );\n\tfloat noiseY = noiseY1 - noiseY2;\n\n\tfloat curl = ( noiseX - noiseY ) * uCurlSpeed;\n\n\t// Write\n\n\tfloat noise = curl * uCurlStrength.z * uWind.z;\n\tz = mix( z, z + noise, uDelta );\n\tz = clamp( z, uBounds.x, uBounds.y );\n\n\tgl_FragColor = packFloat( z );\n\n}\n");var Vt={};function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Wt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zt(Object(n),!0).forEach((function(e){Qt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $t(){return $t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Jt(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$t.apply(this,arguments)}function Jt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=re(t)););return t}function te(t,e){return te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},te(t,e)}function ee(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=re(t);if(e){var i=re(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ne(this,n)}}function ne(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function re(t){return re=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},re(t)}Vt.GPGPU_x=It,Vt.GPGPU_y=Yt,Vt.GPGPU_z=Nt,Vt.material=Xt.getBase(),Vt.material.vertexShader="\nattribute float aNoise;\nattribute vec2 GPGPU_target;\nuniform float uRotation;\nuniform float uTime;\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform vec3 uBounds;\nuniform vec3 uScale;\nvarying float vAltitude;\n\n".concat(Xt.rotateZ,"\n").concat(Xt.floatPack,"\n\nvoid main() {\n\n\tfloat translateX = unpackFloat( texture2D( GPGPU_x, GPGPU_target ) );\n\tfloat translateY = unpackFloat( texture2D( GPGPU_y, GPGPU_target ) );\n\tfloat translateZ = unpackFloat( texture2D( GPGPU_z, GPGPU_target ) );\n\n\tvAltitude = mix( 1.0, 0.0, ( translateY - uBounds.x ) / uBounds.z );\n\t\n\tfloat scale = mix( \n\t\tuScale.x,\n\t\tuScale.y,\n\t\tvAltitude * mix( uScale.z, 1.0, aNoise )\n\t);\n\n\tvec3 transformed = position;\n\ttransformed *= scale * rotateZ( uTime * uRotation * aNoise );\n\ttransformed += vec3( translateX, translateY, translateZ );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),Vt.material.fragmentShader="\nuniform float opacity;\nuniform vec3 uColorLow;\nuniform vec3 uColorHigh;\nvarying float vAltitude;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorHigh, uColorLow, vAltitude );\n\n\tgl_FragColor = vec4( dynamicColor, opacity );\n\n}\n";var ie=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&te(t,e)}(s,t);var n,r,i,o=ee(s);function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return qt(this,s),(t=o.call(this,{defaults:Gt,settings:e})).bounds=new O(t.camera,t.settings.particle.near,t.settings.particle.far),t}return n=s,r=[{key:"init",value:function(){this.effects.add("bloom",new L(this.settings.bloom)),$t(re(s.prototype),"init",this).call(this,Bt)}},{key:"initScene",value:function(){var t=this.random,n=this.settings,r=new e.CircleGeometry(n.disc.size,n.disc.segments),i=new e.MeshBasicMaterial(n.disc.fill),o=new e.Mesh(r,i);o.position.z=n.particle.near+n.disc.offset,this.add(o);var s=new e.EdgesGeometry(r),a=new e.LineBasicMaterial(n.disc.stroke),l=new e.LineSegments(s,a);l.position.copy(o.position),this.add(l);var u=n.GPGPUTextureSize,c=u*u,f=new e.CircleGeometry(n.particle.size,3);f.rotateZ(Math.PI/2);var h=new e.EdgesGeometry(f),p=new Float32Array(c),d=new Float32Array(c),m=new Float32Array(c),v=new Float32Array(2*c),y=new Float32Array(c);this.bounds.update();for(var g=this.bounds,b=g.left,w=g.right,x=g.bottom,P=g.top,k=g.near,O=g.far,S=0,C=0;S<c;S++)p[S]=t.number(b,w),d[S]=t.number(x,P),m[S]=t.number(k,O),v[C++]=S%u/u,v[C++]=~~(S/u)/u,y[S]=t.noise();var _=new e.InstancedBufferGeometry;_.instanceCount=c,_.setAttribute("position",(new e.Float32BufferAttribute).copy(h.attributes.position)),_.setAttribute("GPGPU_target",new e.InstancedBufferAttribute(v,2)),_.setAttribute("aNoise",new e.InstancedBufferAttribute(y,1)),this.particleCountMax=c,this.particleCountMin=Math.round(.1*c),this.initUniforms(p,d,m);var T=new e.ShaderMaterial(Vt.material),j=new e.LineSegments(_,T);j.frustumCulled=!1,this.particles=j,this.add(j),this.updateInstanceCount(),f.dispose(),h.dispose()}},{key:"initUniforms",value:function(t,n,r){var i=this.settings,o=i.curl,s=o.epsilon,a=o.speed,l=o.scale,u=o.strength;this.curlEpsilon=new e.Uniform(s),this.curlScale=new e.Uniform(l),this.curlSpeed=new e.Uniform(a/(2*s)),this.curlStrength=new e.Uniform(new e.Vector3(u.x,u.y,u.z)),this.delta=new e.Uniform(0),this.time=new e.Uniform(0),this.wind=new e.Uniform(new e.Vector3);var c={uEpsilon:this.curlEpsilon,uCurlScale:this.curlScale,uCurlSpeed:this.curlSpeed,uCurlStrength:this.curlStrength,uDelta:this.delta,uTime:this.time,uWind:this.wind},f=new p(this.particleCountMax);this.gpgpu=f,f.addVariable("x",{data:t,shader:Vt.GPGPU_x,uniforms:Wt({uBounds:{value:this.bounds.x}},c)}),f.addVariable("y",{data:n,shader:Vt.GPGPU_y,uniforms:Wt({uBounds:{value:this.bounds.y}},c)}),f.addVariable("z",{data:r,shader:Vt.GPGPU_z,uniforms:Wt({uBounds:{value:this.bounds.z}},c)}),f.assign("x","y"),f.assign("x","z"),f.assign("y","x"),f.assign("y","z"),f.assign("z","x"),f.assign("z","y");var h=new e.Color(i.colorLow),d=new e.Color(i.colorHigh);Vt.material.uniforms={opacity:new e.Uniform(i.opacity),uBounds:new e.Uniform(this.bounds.y),uColorLow:new e.Uniform(h),uColorHigh:new e.Uniform(d),uRotation:new e.Uniform(i.rotation),uScale:new e.Uniform(new e.Vector3(i.scale.top,i.scale.bottom,i.scale.gradient)),uTime:this.time,GPGPU_x:f.x,GPGPU_y:f.y,GPGPU_z:f.z}}},{key:"updateInstanceCount",value:function(){var t=Math.floor(e.MathUtils.clamp(this.settings.particle.count*this.camera.aspect,this.particleCountMin,this.particleCountMax));this.particles.geometry.instanceCount=t}},{key:"resize",value:function(t,e,n){$t(re(s.prototype),"resize",this).call(this,t,e,n),this.particles&&(this.bounds.update(),this.updateInstanceCount())}},{key:"tick",value:function(t){var e=t*this.settings.speed;this.delta.value=e,this.time.value+=e*this.settings.timeFactor,this.gpgpu.tick(),$t(re(s.prototype),"tick",this).call(this,t)}}],r&&Kt(n.prototype,r),i&&Kt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(Et),oe=.05,se={name:"Blockflow",tile:{countX:40,countZ:40,width:.3,height:.1,depth:.3,margin:{x:oe,y:0,z:oe}},border:.875,background:{color1:38323,color2:39270},colorLow:51414,colorHigh:13362688,bloom:{strength:.2,radius:.7,threshold:.5},camera:{start:{x:10,y:5,z:10}},cameraRig:{bounds:{x:8,y:25,z:0},speed:75e-5},cursorProjector:{horizontal:!0,cursorSize:.5,lerp:.007,multiplier:1.5},lerpSpeed:7e-4,speed:{min:2.5,max:3.5,value:3},amplitude:{min:150,max:250,value:200},scale:{min:.2,max:.8,value:.5},thickness:{min:.5,max:1.5,value:1},turbulence:{min:.2,max:1.5,value:1},opacity:{min:.4,max:.6,value:.5}};function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ue(){return ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ce(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ue.apply(this,arguments)}function ce(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=de(t)););return t}function fe(t,e){return fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},fe(t,e)}function he(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=de(t);if(e){var i=de(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return pe(this,n)}}function pe(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}var me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fe(t,e)}(o,t);var e,n,r,i=he(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).amplitude=.5,e.intensity=.5;var n=e.sketch.settings.cursorProjector.multiplier,r=.5*t.width*n,s=.5*t.depth*n;return e.projector.bounds={x:{min:-r,max:r},z:{min:-s,max:s}},e}return e=o,(n=[{key:"tick",value:function(t){if(ue(de(o.prototype),"tick",this).call(this,t),this.trackerEnabled){var e=this.sketch,n=this.tracker,r=this.projector,i=e.settings,s=xt.clamp,a=xt.lerp;r.set(n.polarizeX,n.reversePolarizeY),r.tick(t),r.cursor.position.x=s(r.cursor.position.x,r.bounds.x.min,r.bounds.x.max),r.cursor.position.z=s(r.cursor.position.z,r.bounds.z.min,r.bounds.z.max);var l=s(i.lerpSpeed*t,0,1);this.amplitude=a(this.amplitude,n.reverseY,l),e.amplitude.value=a(i.amplitude.min,i.amplitude.max,this.amplitude),e.opacity.value=a(i.opacity.max,i.opacity.min,this.amplitude),i.speed.value=a(i.speed.min,i.speed.max,this.amplitude),e.setSpeed(),this.intensity=a(this.intensity,n.x,l),e.scale.value=a(i.scale.min,i.scale.max,this.intensity),e.thickness.value=a(i.thickness.max,i.thickness.min,this.intensity),e.turbulence.value=a(i.turbulence.min,i.turbulence.max,this.intensity)}}}])&&le(e.prototype,n),r&&le(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(xt),ve=Xt.getBase();function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function ge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function we(){return we="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=xe(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},we.apply(this,arguments)}function xe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Se(t)););return t}function Pe(t,e){return Pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pe(t,e)}function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Se(t);if(e){var i=Se(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(t,e){if(e&&("object"===ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}ve.vertexShader="\nattribute vec3 aOffset;\nuniform float uAmplitude;\nuniform float uScale;\nuniform float uTime;\nuniform float uThickness;\nuniform float uTurbulence;\nuniform vec3 uCursor;\nvarying float vHeight;\n\n".concat(Xt.simplex3D,"\n\nvoid main() {\n\n\tvec3 transformed = position + aOffset;\n\n\tfloat distanceToCursor = length( uCursor - aOffset );\n\tfloat force = - 1.0 / ( 1.618 + sqrt( distanceToCursor ) );\n\n\tfloat waves = simplex3D(\n\t\tuScale * 0.02 * aOffset.x, \n\t\tdistanceToCursor * 0.1 - uTime,\n\t\tuScale * 0.02 * aOffset.z\n\t) * force * 8.0;\n\n\tfloat turbulence = simplex3D(\n\t\taOffset.x * uScale,\n\t\taOffset.z * uScale,\n\t\tuTime\n\t) * uTurbulence;\n\n\tfloat noise = abs( uThickness + waves + turbulence );\n\n\ttransformed.y *= position.y * noise * uAmplitude;\n\n\tvHeight = transformed.y;\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),ve.fragmentShader="\nuniform float opacity;\nuniform vec3 uColorLow;\nuniform vec3 uColorHigh;\nvarying float vHeight;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorLow, uColorHigh, vHeight );\n\n\tgl_FragColor = vec4( dynamicColor, opacity );\n\n}\n";var Ce=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pe(t,e)}(s,t);var n,r,i,o=ke(s);function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ge(this,s),(t=o.call(this,{defaults:se,settings:e})).setSpeed(),t}return n=s,r=[{key:"init",value:function(){this.effects.add("bloom",new L(this.settings.bloom)),we(Se(s.prototype),"init",this).call(this,me),this.cursor.value=this.controls.cursor.position}},{key:"initScene",value:function(){var t=this.settings,n=t.tile,r=n.countX*n.countZ,i=n.width+n.margin.x,o=n.depth+n.margin.z;this.width=i*n.countX-n.margin.x,this.depth=o*n.countZ-n.margin.z;var s=-(this.width-n.width)/2,a=.5*-n.height,l=-(this.depth-n.depth)/2;this.debug&&console.log({instances:r});for(var u=new e.BoxGeometry(n.width,n.height,n.depth),c=new e.EdgesGeometry(u),f=new Float32Array(c.attributes.position.array),h=3*r,p=new Float32Array(h),d=0,m=0,v=0;v<h;v+=3)p[v]=s+d*i,p[v+1]=a,p[v+2]=l+m*o,0==(d=(d+1)%n.countX)&&m++;var y=new e.InstancedBufferGeometry;y.instanceCount=r,y.setAttribute("position",new e.Float32BufferAttribute(f,3)),y.setAttribute("aOffset",new e.InstancedBufferAttribute(p,3)),this.cursor=new e.Uniform(null),this.amplitude=new e.Uniform(t.amplitude.value),this.scale=new e.Uniform(t.scale.value),this.thickness=new e.Uniform(t.thickness.value),this.turbulence=new e.Uniform(t.turbulence.value),this.time=new e.Uniform(0),this.opacity=new e.Uniform(t.opacity.value),this.colorLow=new e.Uniform(new e.Color(t.colorLow)),this.colorHigh=new e.Uniform(new e.Color(t.colorHigh)),ve.uniforms={uCursor:this.cursor,uAmplitude:this.amplitude,uScale:this.scale,uThickness:this.thickness,uTurbulence:this.turbulence,uTime:this.time,opacity:this.opacity,uColorLow:this.colorLow,uColorHigh:this.colorHigh};var g=new e.ShaderMaterial(ve);this.grid=new e.LineSegments(y,g),this.add(this.grid);var b=new e.PlaneGeometry(this.width+t.border,this.depth+t.border);b.rotateX(-Math.PI/2),this.border=new e.LineSegments(new e.EdgesGeometry(b),g),this.add(this.border),u.dispose(),c.dispose(),b.dispose()}},{key:"tick",value:function(t){this.time.value+=t*this.speed,we(Se(s.prototype),"tick",this).call(this,t)}},{key:"setSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.settings.speed.value,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;this.speed=t*e}}],r&&be(n.prototype,r),i&&be(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(Et);function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function je(t,e){return je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},je(t,e)}function Ee(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=De(t);if(e){var i=De(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(t,e){if(e&&("object"===_e(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function De(t){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},De(t)}var ze=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(o,t);var e,n,r,i=Ee(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).intensity=0,e}return e=o,(n=[{key:"tick",value:function(t){var e=this.sketch,n=this.tracker,r=e.settings,i=xt.lerp;this.projector.set(n.polarizeX,n.reversePolarizeY),this.projector.tick(t);var o=e.camera.aspect>1?n.reverseCenterX:n.reverseCenterY;this.intensity=i(this.intensity,o,r.lerpSpeed),e.depth.value=i(r.depth.max,r.depth.min,this.intensity),e.noiseScale.value=i(r.noiseScale.min,r.noiseScale.max,Math.pow(2*this.intensity,2))}}])&&Te(e.prototype,n),r&&Te(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(xt),Re={name:"Backgrid",background:{color1:526345,color2:2105123},colorInactive:2236966,colorActive:3817541,dot:{size:.038,margin:.14,rows:128},deltaScale:.002,timeScale:2e-4,camera:{start:{x:0,y:0,z:0}},cursorProjector:{lerp:.007},lerpSpeed:.048,depth:{min:.01,max:.1},noiseScale:{min:.001,max:4}},Ue={};function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}function Be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Le(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fe.apply(this,arguments)}function Le(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ne(t)););return t}function Xe(t,e){return Xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xe(t,e)}function Ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ne(t);if(e){var i=Ne(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ye(this,n)}}function Ye(t,e){if(e&&("object"===Ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}Ue.GPGPU_intensity="\nuniform sampler2D GPGPU_intensity;\nuniform sampler2D GPGPU_offsetX;\nuniform sampler2D GPGPU_offsetY;\nuniform vec3 uCursor;\nuniform float uDelta;\nuniform float uNoiseScale;\nuniform float uTime;\n\n".concat(Xt.floatPack,"\n").concat(Xt.simplex3D,"\n\n\tvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat intensity = unpackFloat( texture2D( GPGPU_intensity, uv ) );\n\n\tfloat offsetX = unpackFloat( texture2D( GPGPU_offsetX, uv ) );\n\tfloat offsetY = unpackFloat( texture2D( GPGPU_offsetY, uv ) );\n\tvec3 offset = vec3( offsetX, offsetY, 0.0 );\n\n\t// Modify\n\n\tfloat simplex = simplex3D( \n\t\toffsetX * uNoiseScale, \n\t\toffsetY * uNoiseScale, \n\t\tuTime\n\t);\n\t\n\tfloat waves = ( simplex + 1.0 ) * 5.0;\n\t\n\tfloat cursorReaction = ( 0.5 + abs( simplex ) ) * clamp(\n\t\t7.0 / ( length( uCursor - offset ) + 0.1 ),\n\t\t0.0,\n\t\t10.0\n\t);\n\n\tfloat targetIntensity = clamp( \n\t\t( clamp( waves + cursorReaction, 0.0, 20.0 ) - 10.0 ) * 0.2,\n\t\t-1.0,\n\t\t1.0\n\t);\n\n\tintensity = mix( intensity, targetIntensity, uDelta );\n\n\t// Write\n\n\tgl_FragColor = packFloat( intensity );\n\n}\n"),Ue.cores=Xt.getBase(),Ue.cores.vertexShader="\nattribute float aOffsetX;\nattribute float aOffsetY;\nattribute vec2 GPGPU_target;\nuniform sampler2D GPGPU_intensity;\nuniform float uDepth;\nvarying float vIntensity;\n".concat(Xt.floatPack,"\n\nvoid main() {\n\n\tfloat intensity = unpackFloat( texture2D( GPGPU_intensity, GPGPU_target ) );\n\tvIntensity = ( intensity + 1.0 ) / 2.0;\n\n\tvec3 transformed = position;\n\ttransformed *= vIntensity;\n\ttransformed += vec3( aOffsetX, aOffsetY, ( intensity - 1.0) * uDepth );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),Ue.cores.fragmentShader="\nuniform vec3 uColorActive;\nuniform vec3 uColorInactive;\nvarying float vIntensity;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorInactive, uColorActive, vIntensity );\n\n\tgl_FragColor = vec4( dynamicColor, 1.0 );\n\n}\n",Ue.shells=Xt.getBase(),Ue.shells.vertexShader="\nattribute float aOffsetX;\nattribute float aOffsetY;\nattribute vec2 GPGPU_target;\nuniform sampler2D GPGPU_intensity;\nuniform float uDepth;\nvarying float vIntensity;\n".concat(Xt.floatPack,"\n\nvoid main() {\n\n\tfloat intensity = unpackFloat( texture2D( GPGPU_intensity, GPGPU_target ) );\n\tvIntensity = ( intensity + 1.0 ) / 2.0;\n\n\tvec3 transformed = position;\n\ttransformed *= vIntensity;\n\ttransformed += vec3( aOffsetX, aOffsetY, vIntensity * uDepth );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),Ue.shells.fragmentShader="\nuniform vec3 uColorActive;\nuniform vec3 uColorInactive;\nvarying float vIntensity;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorInactive, uColorActive, vIntensity );\n\n\tgl_FragColor = vec4( dynamicColor, 1.0 );\n\n}\n";var Ve=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xe(t,e)}(s,t);var n,r,i,o=Ie(s);function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Be(this,s),(t=o.call(this,{defaults:Re,settings:e})).offset=0,t}return n=s,r=[{key:"init",value:function(){Fe(Ne(s.prototype),"init",this).call(this,ze),this.cursor.value=this.controls.cursor.position}},{key:"initScene",value:function(){var t=this.settings,n=new e.Group;this.add(n);for(var r=t.dot.rows,i=r*r,o=t.dot.size,s=o+t.dot.margin,a=s*r,l=(s-a)/2,u=-(s-a)/2,c=new Float32Array(i),f=new Float32Array(i),h=new Float32Array(2*i),p=0,d=0,m=0;m<r;m++)for(var v=0;v<r;v++){var y=l+v*s,g=u-m*s;c[p]=y,f[p]=g,h[d++]=p%r/r,h[d++]=~~(p/r)/r,p++}this.dotCount=i,this.tileSize=s,this.totalSize=a,this.initUniforms(c,f);var b=new e.InstancedBufferAttribute(c,1),w=new e.InstancedBufferAttribute(f,1),x=new e.InstancedBufferAttribute(h,2);function P(t){t.setAttribute("aOffsetX",b),t.setAttribute("aOffsetY",w),t.setAttribute("GPGPU_target",x)}var k=new e.PlaneGeometry(o,o),O=new e.InstancedBufferGeometry;O.instanceCount=i,O.setAttribute("position",(new e.Float32BufferAttribute).copy(k.attributes.position)),O.setIndex((new e.Uint16BufferAttribute).copy(k.index)),P(O);var S=new e.ShaderMaterial(Ue.cores),C=new e.Mesh(O,S);n.add(C);var _=new e.EdgesGeometry(k),T=new e.InstancedBufferGeometry;T.instanceCount=i,T.setAttribute("position",(new e.Float32BufferAttribute).copy(_.attributes.position)),P(T);var j=new e.ShaderMaterial(Ue.shells),E=new e.LineSegments(T,j);n.add(E),this.container=n,this.cores=C,this.shells=E,k.dispose(),_.dispose()}},{key:"initUniforms",value:function(t,n){var r=this.settings;this.colorActive=new e.Color(r.colorActive),this.colorInactive=new e.Color(r.colorInactive),this.cursor=new e.Uniform(null),this.time=new e.Uniform(0),this.delta=new e.Uniform(0),this.depth=new e.Uniform(r.depth.min),this.noiseScale=new e.Uniform(r.noiseScale.max);var i=new p(this.dotCount);i.addConstant("offsetX",t),i.addConstant("offsetY",n),i.addVariable("intensity",{shader:Ue.GPGPU_intensity,uniforms:{GPGPU_offsetX:i.offsetX,GPGPU_offsetY:i.offsetY,uCursor:this.cursor,uDelta:this.delta,uNoiseScale:this.noiseScale,uTime:this.time}}),this.gpgpu=i;var o={GPGPU_intensity:i.intensity,uColorActive:new e.Uniform(this.colorActive),uColorInactive:new e.Uniform(this.colorInactive),uDepth:this.depth};Ue.cores.uniforms=o,Ue.shells.uniforms=o}},{key:"resize",value:function(t,e,n){Fe(Ne(s.prototype),"resize",this).call(this,t,e,n);var r=Math.abs(1-this.camera.aspect);this.camera.position.z=Math.max(8-r,1)}},{key:"tick",value:function(t){this.delta.value=t*this.settings.deltaScale,this.time.value+=t*this.settings.timeScale,this.gpgpu.tick(),this.container.position.x=this.offset%this.tileSize,Fe(Ne(s.prototype),"tick",this).call(this,t)}}],r&&Ge(n.prototype,r),i&&Ge(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(Et);function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function We(t,e){return We=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},We(t,e)}function Qe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ke(t);if(e){var i=Ke(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qe(this,n)}}function qe(t,e){if(e&&("object"===He(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ke(t){return Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ke(t)}var $e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&We(t,e)}(o,t);var e,n,r,i=Qe(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).amplitude=.5,e.intensity=.5,e}return e=o,(n=[{key:"tick",value:function(t){var e=xt.clamp,n=xt.lerp,r=this.sketch,i=this.tracker,o=r.settings,s=e(o.lerpSpeed*t,0,1);this.cameraRigEnabled&&this.cameraRig.update(i.reversePolarizeX,i.y).tick(t);var a=i.x;this.amplitude=n(this.amplitude,a,s);var l=r.noiseScale.value;l.x=n(o.noiseScaleX.min,o.noiseScaleX.max,this.amplitude),l.y=n(o.noiseScaleY.min,o.noiseScaleY.max,this.amplitude),r.amp.value=n(o.amp.min,o.amp.max,this.amplitude);var u=i.reverseY;this.intensity=n(this.intensity,u,s),r.opacity.value=n(o.opacity.min,o.opacity.max,this.intensity),o.speed.value=n(o.speed.min,o.speed.max,this.intensity)}}])&&Ze(e.prototype,n),r&&Ze(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(xt),Je={name:"Navscan",background:{color1:16015,color2:6815877},grid:{color:16734254,opacity:.8,z:10},tiles:{x:400,z:200,width:.4,depth:.4},camera:{start:{x:0,y:0,z:5},lookAt:{x:0,y:0,z:-5}},cameraRig:{bounds:{x:5,y:10,z:0}},bloom:{strength:.8,radius:.8,threshold:.25},lerpSpeed:7e-4,noiseScaleX:{min:.01,max:.25},noiseScaleY:{min:0,max:.1},amp:{min:1,max:2.5},opacity:{min:.4,max:.8},speed:{min:.002,max:.012,value:.01}},tn=Xt.getBase();function en(t){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},en(t)}function nn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function on(){return on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=sn(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},on.apply(this,arguments)}function sn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cn(t)););return t}function an(t,e){return an=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},an(t,e)}function ln(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=cn(t);if(e){var i=cn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return un(this,n)}}function un(t,e){if(e&&("object"===en(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cn(t){return cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cn(t)}tn.vertexShader="\nuniform float uAmp;\nuniform float uDistance;\nuniform vec3 uNoiseScale;\n\n".concat(Xt.simplex3D,"\n\nvoid main() {\n\n\tvec3 transformed = position;\n\n\t// Z\n\ttransformed.z += mod( uDistance, 0.4 );\n\n\t// Y\n\tfloat x = position.x;\n\tfloat z = uDistance - transformed.z;\n\tfloat noise = simplex3D( \n\t\tx * uNoiseScale.x,\n\t\tmod( x, 2.0 ) *uNoiseScale.y,\n\t\tz * uNoiseScale.z\n\t);\n\n\tfloat largeNoise = uAmp * (\n\t\tsimplex3D( x * 0.03, z * 0.03, uNoiseScale.x ) * 0.7 - 1.0\n\t);\n\n\ttransformed.y = uAmp * ( clamp( noise * uAmp, -0.3, 0.3 ) + largeNoise );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),tn.fragmentShader="\nuniform vec3 color;\nuniform float opacity;\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity );\n\n}\n";var fn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&an(t,e)}(s,t);var n,r,i,o=ln(s);function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return nn(this,s),o.call(this,{defaults:Je,settings:t})}return n=s,(r=[{key:"init",value:function(){this.effects.add("bloom",new L(this.settings.bloom)),on(cn(s.prototype),"init",this).call(this,$e)}},{key:"initScene",value:function(){var t=this.settings,n=-t.tiles.x*t.tiles.width/2,r=-t.tiles.z*t.tiles.depth,i=t.tiles.x+1,o=t.tiles.z+1,s=t.tiles.x*t.tiles.z,a=i*o,l=8*s;this.debug&&console.log({points:a,tiles:s});for(var u=new Float32Array(3*l),c=new Float32Array(a),f=new Float32Array(a),h=0,p=0,d=0,m=0,v=0;v<a;v++)c[h++]=n+t.tiles.width*d,f[p++]=r+t.tiles.depth*m,0==(d=(d+1)%i)&&m++;var y,g,b,w,x=0,P=0,k=0;d=0,m=0;for(var O=function(t){u[x++]=c[t],u[x++]=0,u[x++]=f[t]},S=function(t,e){O(t),O(e)},C=0;C<s;C++)w=(b=C+i+k)+1,S(y=C+k,g=y+1),S(g,w),S(w,b),S(b,y),0==(P=(P+1)%t.tiles.x)&&k++;var _=new e.BufferGeometry;_.setAttribute("position",new e.Float32BufferAttribute(u,3)),this.amp=new e.Uniform(2),this.distance=new e.Uniform(0),this.noiseScale=new e.Uniform(new e.Vector3(.1,.03,.07)),this.color=new e.Uniform(new e.Color(t.grid.color)),this.opacity=new e.Uniform(t.grid.opacity),tn.uniforms={color:this.color,opacity:this.opacity,uAmp:this.amp,uDistance:this.distance,uNoiseScale:this.noiseScale};var T=new e.ShaderMaterial(tn),j=new e.LineSegments(_,T);j.position.set(0,0,t.grid.z),this.add(j),this.grid=j}},{key:"tick",value:function(t){this.distance.value+=this.settings.speed.value*t,on(cn(s.prototype),"tick",this).call(this,t)}}])&&rn(n.prototype,r),i&&rn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(Et);function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dn(t,e){return dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},dn(t,e)}function mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=yn(t);if(e){var i=yn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vn(this,n)}}function vn(t,e){if(e&&("object"===hn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function yn(t){return yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},yn(t)}var gn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dn(t,e)}(o,t);var e,n,r,i=mn(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).intensity=.5,e}return e=o,(n=[{key:"tick",value:function(t){var e=xt.clamp,n=xt.lerp,r=this.sketch,i=this.tracker,o=r.settings,s=e(o.lerpSpeed*t,0,1);this.cameraRig.update(i.reversePolarizeX,i.y).tick(t);var a=i.centerX;this.intensity=n(this.intensity,a,s),r.mesh.material.opacity=n(o.opacity.min,o.opacity.max,this.intensity),r.effects.passes.bloom.strength=n(o.bloomStrength.min,o.bloomStrength.max,this.intensity),r.speed=n(o.speed.min,o.speed.max,this.intensity);var l=n(o.minCount,r.maxCount,i.y);r.mesh.count=n(r.mesh.count,l,s)}}])&&pn(e.prototype,n),r&&pn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(xt),bn={name:"Rain II",random:!0,instances:2e3,offsetY:-5,originZ:-10,maxAngle:2*Math.PI,ratio:1.2,geometry:{innerRadius:.6,outerRadius:.72,thetaSegments:6},background:{color1:2490445,color2:26065},material:{color:6467070,transparent:!0},bloom:{strength:.62,radius:.7,threshold:.33},camera:{start:{x:0,y:5,z:10}},cameraRig:{bounds:{x:3,y:10,z:0},intro:{x:0,y:4,z:4}},lerpSpeed:.001,opacity:{min:.5,max:1},bloomStrength:{min:.4,max:.8},speed:{min:1e-4,max:4e-4},minCount:20},wn={};function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function Pn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function On(){return On="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Sn(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},On.apply(this,arguments)}function Sn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jn(t)););return t}function Cn(t,e){return Cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Cn(t,e)}function _n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=jn(t);if(e){var i=jn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Tn(this,n)}}function Tn(t,e){if(e&&("object"===xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function jn(t){return jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},jn(t)}wn.edit=function(t){return Xt.editBasic(t,"\nattribute float aProgress;\nvarying float vProgress;\n","\n\tvProgress = aProgress;\n","\nvarying float vProgress;\n","\n\tdiffuseColor.a *= mod( 1.0 - vProgress, 1.0 );\n")};var En=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cn(t,e)}(s,t);var n,r,i,o=_n(s);function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Pn(this,s),(t=o.call(this,{defaults:bn,settings:e})).y=t.settings.offsetY,t.speed=t.settings.speed.min,t.originZ=t.settings.originZ,t}return n=s,r=[{key:"init",value:function(){this.effects.add("bloom",new L(this.settings.bloom)),On(jn(s.prototype),"init",this).call(this,gn)}},{key:"initScene",value:function(){var t=this.settings.geometry,n=t.innerRadius,r=t.outerRadius,i=t.thetaSegments,o=new e.RingGeometry(n,r,i);o.rotateX(-Math.PI/2);var s=new e.MeshBasicMaterial(this.settings.material);s.onBeforeCompile=wn.edit;var a=this.settings.instances;this.mesh=new e.InstancedMesh(o,s,a),this.add(this.mesh),this.dummy=new e.Object3D;var l=new Float32Array(a);this.x=new Float32Array(a),this.z=new Float32Array(a);for(var u=0;u<a;u++){this.randomizePositionAt(u);var c=this.random.amount();this.dummy.scale.set(c,c,c),l[u]=c,this.dummy.updateMatrix(),this.mesh.setMatrixAt(u,this.dummy.matrix)}o.setAttribute("aProgress",new e.InstancedBufferAttribute(l,1)),this.mesh.instanceMatrix.setUsage(e.DynamicDrawUsage),this.mesh.count=this.maxCount}},{key:"randomizePositionAt",value:function(t){var e=this.random.number(0,this.settings.maxAngle);this.dummy.position.set(Math.cos(e)*this.random.amount()*this.width,this.y,Math.sin(e)*this.random.amount()*this.depth+this.settings.originZ),this.x[t]=this.dummy.position.x,this.z[t]=this.dummy.position.z}},{key:"updateAspect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.camera.aspect;this.maxCount=this.settings.instances,this.maxCount=t<1?Math.round(this.settings.instances*t):this.settings.instances,this.width=O.getVisibleWidth(this.camera,this.settings.originZ),this.depth=this.width*this.settings.ratio/t}},{key:"resize",value:function(t,e,n){On(jn(s.prototype),"resize",this).call(this,t,e,n),this.updateAspect()}},{key:"tick",value:function(t){var e=this.speed*t;if(!e)return On(jn(s.prototype),"tick",this).call(this,t);for(var n=this.mesh.geometry.attributes.aProgress.array,r=0;r<this.mesh.count;r++){var i=n[r]+e;i>1?(i=0,this.randomizePositionAt(r)):this.dummy.position.set(this.x[r],this.y,this.z[r]),this.dummy.scale.set(i,i,i),this.dummy.updateMatrix(),this.mesh.setMatrixAt(r,this.dummy.matrix),n[r]=i}this.mesh.instanceMatrix.needsUpdate=!0,this.mesh.geometry.attributes.aProgress.needsUpdate=!0,On(jn(s.prototype),"tick",this).call(this,t)}}],r&&kn(n.prototype,r),i&&kn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(Et);function Mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mn(Object(n),!0).forEach((function(e){zn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Un(t,e,n){return e&&Rn(t.prototype,e),n&&Rn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var An=Un((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=document.getElementById("background");this.container=e,this.sketchpad=new b({container:e}),p.init(this.sketchpad.renderer);var n={sketchpad:this.sketchpad,renderToScreen:!1};this.grid=new Ve(Dn({},n)),this.navscan=new fn(Dn({},n)),this.rain=new En(Dn({},n)),this.blockflow=new Ce(Dn({},n)),this.ablaze=new ie(Dn({},n));var r=[this.grid,this.navscan,this.rain,this.blockflow,this.ablaze];this.mixer=new P(this.sketchpad.renderer,r),this.sketchpad.init(this.mixer)}));function Bn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,r=e.id,i=e.sketch;Bn(this,t),this.type=n,this.sketch=i,this.id=r,this.domElement=document.getElementById(r)}var e,n,r;return e=t,(n=[{key:"show",value:function(){this.domElement.style.display="flex"}},{key:"hide",value:function(){this.domElement.style.display="none"}}])&&Gn(e.prototype,n),r&&Gn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Fn.types={HOME:"home",INTRO:"intro",WORKS:"works",INFO:"info"};const Ln={int:(t,e)=>Math.floor(Math.random()*(e-t+1)+t),uint:t=>Ln.int(0,t),char:t=>t.charAt(Ln.uint(t.length-1))};class Xn{constructor({from:t,to:e,steps:n,stagger:r,noise:i,charset:o,origin:s,output:a}={}){Object.assign(this,{from:t,to:e,steps:n,stagger:r,noise:i,charset:o,origin:s,output:a}),this.length=Math.max(t.length,e.length),a&&(a.textform=this),this.build(),this.reset()}build(){const{length:t,from:e,to:n}=this,r=this.compute(),i=t=>{const i=e.charAt(t),o=n.charAt(t),s=t=>t.match(/\r|\n|\t/);if(s(i))return[{frame:0,char:i}];if(s(o))return[{frame:0,char:o}];const a=this.applyNoise(this.steps),l=r[t],u=l+a,c=t=>{const e=l+t;return{frame:e,char:e===l?i:e===u?o:Ln.char(this.charset)}};return Array.from({length:a+1},((t,e)=>c(e)))},o=Array.from({length:t},((t,e)=>i(e)));this.finalFrame=o.flat().reduce(((t,e)=>Math.max(t,e.frame)),0),this.scenario=o}compute(){const{length:t,stagger:e,origin:n}=this;return n?Array.from({length:t},((r,i)=>{const o=i-n,s=o>=0?o*e:(t+o)*e;return this.applyNoise(s)})):Array.from({length:t},((t,n)=>{const r=n*e;return this.applyNoise(r)}))}applyNoise(t){const{noise:e}=this;return e?Ln.int(t,t+e):t}getCharAt(t,e){const n=this.scenario[t];let r=n.filter((t=>t.frame===e))[0];if(!r){const t=n[0].frame,i=n[n.length-1].frame,o=e>i?i:t;r=n.filter((t=>t.frame===o))[0]}return r.char}reset(){this.progress=0}update(){const{frame:t,length:e,output:n}=this;this.chars=Array.from({length:e},((e,n)=>this.getCharAt(n,t))),this.text=this.chars.join(""),n&&n.update()}get frame(){return this._frame}set frame(t){t!==this._frame&&(this._frame=t,this.update())}get progress(){return this._progress}set progress(t){this._progress=t,this.frame=Math.round(this.finalFrame*t)}get hasOrigin(){const{origin:t,length:e}=this;return void 0!==t&&t>=0&&t<e}}class In{constructor(t=null,e=0){this.callbacks="function"==typeof t?[t]:t,this.fps=e,this.elapsed=0,this._previous=0,this._delta=0,this._isPlaying=!1}reset(){this.elapsed=0}start(){this._previous=this.now,this._delta=0,this._isPlaying=!0,this.requestAnimationFrame()}pause(){this._isPlaying=!1}stop(){this.pause(),this.reset()}update(){if(!this.isPlaying)return;const t=this.now,e=t-this._previous;this._previous=t,this._delta+=e,this.elapsed+=e;const n=this._frameDuration-this._delta;n<=0&&(this.callbacks.forEach((t=>t.call())),this._delta=Math.abs(n)),this.requestAnimationFrame()}requestAnimationFrame(){requestAnimationFrame(this.update.bind(this))}get fps(){return this._fps}set fps(t){this._fps=t,this._frameDuration=t>0?Math.floor(1e3/t):0}get isPlaying(){return this._isPlaying}get now(){return In.time.now()}}In.time=void 0===performance?Date:performance;const Yn={linear:t=>t},Nn={Sine:t=>1-Math.cos(t*Math.PI/2),Circ:t=>1-Math.sqrt(1-t*t),Quad:t=>Math.pow(t,2),Cubic:t=>Math.pow(t,4),Quart:t=>Math.pow(t,6),Quint:t=>Math.pow(t,8),Expo:t=>Math.pow(t,10)};Object.keys(Nn).forEach((t=>{const e=Nn[t];Yn["easeIn"+t]=e,Yn["easeOut"+t]=t=>1-e(1-t),Yn["easeInOut"+t]=t=>t<.5?e(2*t)/2:1-e(-2*t+2)/2}));const Vn={};Object.keys(Yn).forEach((t=>{let e=t.toUpperCase();const n=e.match(/(EASEINOUT|EASEOUT|EASEIN)(.*)/);if(n){const t=n[1].replace("EASE","").replace("INOUT","IN_OUT");e=`${n[2]}_${t}`}Vn[e]=t})),Yn.keys=Vn;class Hn{constructor({textform:t,delay:e,duration:n,easing:r,reversed:i,reverseSpeed:o,reverseDelay:s,repeat:a,yoyo:l,onBegin:u,onUpdate:c,onChange:f,onComplete:h}={}){this.clock=new In(this.animate.bind(this),Hn.FPS_CAP),this._progress=0,this._isReversed=i,s||(s=e),Object.assign(this,{textform:t,delay:e,duration:n,reverseSpeed:o,reverseDelay:s,repeat:a,isYoyo:l,onBegin:u,onUpdate:c,onChange:f,onComplete:h}),this.ease=Yn[r]||Yn.linear}animate(){const t=this.isReversed?this.reverseSpeed:1,e=this.isReversed?this.reverseDelay:this.delay,n=this.clock.elapsed*t-e;if(n<0)return;this.onUpdate&&this.onUpdate.call();const r=n/this.duration;this.progress=this.isReversed?1-r:r,r>=1&&(this.progress=Math.round(this.progress),this.isReversed&&this.onBegin?this.onBegin.call():this.onComplete&&this.onComplete.call(),this.isYoyo&&(this.isReversed=!this.isReversed),this.stop(),0!==this.repeat&&this.play(!0),this.repeat>0&&this.repeat--)}reset(){this.textform.progress=this.isReversed?1:0}play(t=!1){(this.isPlaying||this.isComplete)&&(this.stop(),t||(this.reset(),this.isReversed&&this.onComplete?this.onComplete.call():!this.isReversed&&this.onBegin&&this.onBegin.call())),this.start()}start(){this.clock.start()}pause(){this.clock.pause()}stop(){this.clock.stop()}setClockFromProgress(){this.clock.elapsed=this.isReversed?(this.delay+(1-this.progress)*this.duration)/this.reverseSpeed:this.delay+this.progress*this.duration}get frame(){return this.textform.frame}get progress(){return this._progress}set progress(t){t<0?t=0:t>1&&(t=1),this._progress=t,this.isPlaying||this.setClockFromProgress();const e=this.textform.frame;this.textform.progress=this.ease(t),this.textform.frame!==e&&this.onChange&&this.onChange.call()}get isReversed(){return this._isReversed}set isReversed(t){t!==this._isReversed&&(this._isReversed=t,this.setClockFromProgress())}get isPlaying(){return this.clock.isPlaying}get isComplete(){return this.isYoyo?this.isReversed?this.progress>=1:this.progress<=0:this.isReversed?this.progress<=0:this.progress>=1}}Hn.FPS_CAP=60;class Zn extends Xn{compute(){return super.compute().reverse()}}class Wn extends Xn{compute(){const{length:t,stagger:e,origin:n,hasOrigin:r}=this,i=r?n:Math.floor((t-1)/2),o=r||t%2!=0?i:i+1;return Array.from({length:t},((t,n)=>{const r=n<o?i-n:n-o;return this.applyNoise(r*e)}))}}class Qn extends Xn{compute(){const{length:t,stagger:e,origin:n,hasOrigin:r}=this,i=r?n:Math.round((t-1)/2);return Array.from({length:t},((n,r)=>{const o=r<i?r:t-1-r;return this.applyNoise(o*e)}))}}class qn extends Xn{compute(){const{origin:t,stagger:e}=this;let n=qn.shuffle(super.compute());return this.hasOrigin&&e>0?(n=n.filter((t=>t>0)),n.splice(t,0,0),n):n}}qn.shuffle=t=>{let e=[...t];for(let n=t.length-1;n>0;n--){const t=Math.floor(Math.random()*(n+1));[e[n],e[t]]=[e[t],e[n]]}return e};const Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZ",$n=Kn.toLowerCase(),Jn="0123456789",tr="!@#$%&",er=[Kn,$n,Jn,tr].join(""),nr={UPPERCASE:Kn,LOWERCASE:$n,DIGITS:Jn,SYMBOLS:tr,ALL:er},rr={pad:(t,e,n,r)=>{const i=r-t.length;if(0===i)return t;const o={left:()=>0,center:()=>Math.floor(i/2),right:()=>i,default:()=>e},s=(o[e]||o.default)();return(a=n,l=t,u=s,[a.slice(0,u),l,a.slice(u)].join("")).slice(0,r);var a,l,u},align:(t,e,n)=>{if(e===rr.to.NONE)return t;n||(n=" ");const r=t.reduce(((t,e)=>Math.max(t,e.length)),0),i=n.length,o=Math.ceil(r/i),s=n.repeat(o).substring(0,r);return t.map((t=>rr.pad(t,e,s,r)))},to:{NONE:"none",LEFT:"left",CENTER:"center",RIGHT:"right"}};class ir{constructor(t){this.input=t}update(){if(!this.textform)return;const t=this.textform.text;if(this.object)return this.object.textform=t;if(this.console)return console.log(t);if(!this.elements)return;const e=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),n=(n=>{const r=[];for(let i=0;i<n.length;i++)" "===this?.referenceText.charAt(i)?r.push(" "):" "===t.charAt(i)?r.push("&numsp;"):r.push(e(t.charAt(i)));return r.join("").replace(/\t/g,"&emsp;").replace(/\n/g,"<br>")})(t);this.elements.forEach((t=>t.innerHTML=n))}get input(){return this._input}set input(t){if(this.console=null,this.elements=null,this.object=null,void 0!==t)if(t!==console)if(void 0===t.innerHTML){if("string"==typeof t){const e=/\.\w\S*/;if(t.match(e)){const e=document.getElementsByClassName(t.substring(1));return void(e.length&&(this.elements=Array.from(e)))}const n=/#\w\S*/;if(t.match(n)){const e=document.querySelector(t);return void(e&&(this.elements=[e]))}}try{void 0===t.textform&&(t.textform=""),this.object=t}catch(t){return}}else this.elements=[t];else this.console=t}get isValid(){return void 0!==this.object||void 0!==this.console||void 0!==this.elements}get inputText(){return this.object&&this.object.textform?this.object.textform:this.elements?this.elements[0].textContent:void 0}}class or{constructor({mode:t=or.modes.BASIC,from:e,to:n,steps:r=5,stagger:i=3,noise:o=0,charset:s=or.charsets.ALL,origin:a,output:l,align:u=or.align.NONE,fill:c=" ",autoplay:f=!0,speed:h=or.DEFAULT_SPEED,easing:p=or.DEFAULT_EASING,delay:d=0,duration:m=0,reversed:v=!1,reverseSpeed:y=1,reverseDelay:g,repeat:b=0,loop:w=!1,yoyo:x=!1,onBegin:P,onUpdate:k,onChange:O,onComplete:S,hover:C=!1,press:_=!1}={}){this.__init(),this.build({mode:t,from:e,to:n,steps:r,stagger:i,noise:o,charset:s,origin:a,output:l,align:u,fill:c,autoplay:f,speed:h,easing:p,delay:d,duration:m,reversed:v,reverseSpeed:y,reverseDelay:g,repeat:b,loop:w,yoyo:x,onBegin:P,onUpdate:k,onChange:O,onComplete:S,hover:C,press:_})}build(t=this.options){this.options=t,this.dispose();const e={default:Xn,basic:Xn,reverse:Zn,expand:Wn,collapse:Qn,shuffle:qn},n=new(e[t.mode]||e.default)(this.__.textformOptions());if(this.textform=n,t.hover||t.press)this.bind();else if(!t.autoplay)return;this.player=new Hn(this.__.autoplayOptions()),t.autoplay&&this.play()}clone(t={output:void 0}){const e={...this.options,...t};return new or(e)}dispose(){this.stop(),this.unbind()}convertSpeedToDuration(t=this.options.speed){if(!this.textform)return or.DEFAULT_DURATION;return this.textform.finalFrame*(1e3/t)}__init(){const t={};t.in=function(){const{player:t}=this;t&&(t.isReversed=!1),!t.isPlaying&&t.progress<1&&t.play()}.bind(this),t.out=function(){const{player:t}=this;t&&(t.isReversed=!0),!t.isPlaying&&t.progress>0&&t.play()}.bind(this),t.textformOptions=function(){const{DEFAULT_TEXT:t}=or,e={...this.options},{from:n,to:r,align:i,fill:o}=e,s=new ir(e.output);if(s.isValid){const i=s.inputText||t;s.referenceText=r||n||i,void 0===n&&(e.from=i),void 0===r&&(e.to=i),e.output=s}else e.output=void 0;if(e.from||(e.from=t),e.to||(e.to=t),i){const t=rr.align([e.from,e.to],i,o);e.from=t[0],e.to=t[1]}return e}.bind(this),t.autoplayOptions=function(){const{textform:t}=this,e={...this.options,textform:t};return e.duration||(e.duration=this.convertSpeedToDuration(e.speed)),e.loop&&(e.repeat=-1),e}.bind(this),this.__=t}bind(t=this.options.hover,e=this.options.press){const{textform:n,options:r}=this;if(Object.assign(r,{hover:t,press:e}),!t&&!e)return;if(!n||!n.output||!n.output.elements)return;const{elements:i}=n.output;i.forEach((n=>{t&&(n.addEventListener("pointerenter",this.__.in),n.addEventListener("pointerleave",this.__.out)),e&&(n.addEventListener("pointerdown",this.__.in),n.addEventListener("pointerup",this.__.out))})),this.dispatchers=i}unbind(){this.dispatchers&&(this.dispatchers.forEach((t=>{t.addEventListener("pointerenter",this.__.in),t.addEventListener("pointerleave",this.__.out),t.addEventListener("pointerdown",this.__.in),t.addEventListener("pointerup",this.__.out)})),this.dispatchers=null)}play(){this.player&&this.player.play()}pause(){this.player&&this.player.pause()}stop(){this.player&&this.player.stop()}get progress(){return this.player?this.player.progress:this.textform.progress}set progress(t){this.player?this.player.progress=t:this.textform.progress=t}get speed(){return this.options.speed}set speed(t){const{options:e}=this;t<1&&(t=or.DEFAULT_SPEED),e.speed=t,e.duration=this.convertSpeedToDuration(t)}get text(){return this.textform.text}}function sr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ar(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sr(Object(n),!0).forEach((function(e){lr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function lr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}or.align=rr.to,or.charsets=nr,or.easing=Yn,or.ease=Yn.keys,or.modes={BASIC:"basic",REVERSE:"reverse",EXPAND:"expand",COLLAPSE:"collapse",SHUFFLE:"shuffle"},or.DEFAULT_TEXT="",or.DEFAULT_SPEED=15,or.DEFAULT_DURATION=1e3,or.DEFAULT_EASING=or.ease.LINEAR;var cr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e={autoplay:!1,from:"",steps:8,stagger:6,align:or.align.LEFT},n=new or(ar(ar({},e),{},{output:"#name-first",mode:or.modes.REVERSE})),r=new or(ar(ar({},e),{},{output:"#name-alias",mode:or.modes.EXPAND})),i=new or(ar(ar({},e),{},{output:"#vocation"}));this.textformers=[n,r,i]}var e,n,r;return e=t,(n=[{key:"progress",get:function(){return this.textformers[0].progress},set:function(t){this.textformers.forEach((function(e){return e.progress=t}))}}])&&ur(e.prototype,n),r&&ur(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var hr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.back=document.getElementById("arrow-back"),this.forward=document.getElementById("arrow-forward"),this.nav=["intro","works","about"].reduce((function(t,e){var n=document.getElementById("nav-".concat(e));return n.setAttribute("href","javascript:void(0)"),t[e]=n,t}),{})}var e,n,r;return e=t,(n=[{key:"setArrows",value:function(t,e){var n="hidden",r="visible";this.back.style.visibility=t?n:r,this.forward.style.visibility=e?n:r}}])&&fr(e.prototype,n),r&&fr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const pr=anime;var dr=t.n(pr);function mr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function vr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mr(Object(n),!0).forEach((function(e){yr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var br=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.portfolio=e,this.dynamicTitle=document.getElementById("dynamic-title")}var e,n,r;return e=t,(n=[{key:"tween",value:function(t,e,n){this.tweenBackground(t,e,n),this.tweenGrid(t,e,n),this.tweenTitle(t,e,n),this.tweenPreviews(t,e,n)}},{key:"tweenBackground",value:function(t,e,n){if(t.sketch!==e.sketch){var r=this.portfolio.background.mixer,i=t.sketch,o=e.sketch,s=[0,1];n&&(i=e.sketch,o=t.sketch,s=[1,0]),r.set(i,o),dr()({duration:1e3,easing:"easeOutCirc",targets:r,mix:s})}}},{key:"tweenGrid",value:function(t,e,n){var r=this.portfolio.background.grid;if(t.sketch===r||e.sketch===r){var i=21*r.tileSize,o=n?i:-i;dr()({duration:1500,easing:"easeOutCirc",targets:r,offset:[0,o]})}}},{key:"tweenTitle",value:function(t,e){var n=this.portfolio.title,r=Fn.types.INTRO,i={duration:1e3,easing:"easeOutQuad",targets:n};t.type!==r&&e.type===r?dr()(vr(vr({},i),{},{delay:400,progress:1})):t.type===r&&e.type!==r&&dr()(vr(vr({},i),{},{progress:0}))}},{key:"tweenPreviews",value:function(t,e,n){var r=Fn.types.WORKS,i={duration:500,easing:"easeInOutQuad"},o={autoplay:!1,steps:8,stagger:4,output:this.dynamicTitle,mode:n?or.modes.NORMAL:or.modes.REVERSE};if(t.type===r&&dr()(vr(vr({},i),{},{targets:t.domElement,opacity:[1,0],complete:function(){return t.video.pause()}})),e.type===r){dr()(vr(vr({},i),{},{targets:e.domElement,opacity:[0,1],begin:function(){return e.video.play()}}));var s=new or(vr(vr({},o),{},{to:e.id}));dr()(vr(vr({},i),{},{duration:700,targets:s,progress:1}))}else{var a=new or(vr(vr({},o),{},{to:""}));dr()(vr(vr({},i),{},{duration:750,targets:a,progress:1}))}}}])&&gr(e.prototype,n),r&&gr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.init(e),this.initButtons(e),this.initMouse(e),this.initTouch(e),this.initKeyboad(e)}var e,n,r;return e=t,n=[{key:"init",value:function(t){window.addEventListener("hashchange",(function(){return t.load()}))}},{key:"initButtons",value:function(t){var e=t.ui,n=e.back,r=e.forward,i=e.nav;n.addEventListener("click",(function(){return t.back()})),r.addEventListener("click",(function(){return t.forward()})),i.intro.addEventListener("click",(function(){return t.goto("home")})),i.works.addEventListener("click",(function(){return t.goto("orion")})),i.about.addEventListener("click",(function(){return t.goto("about")}))}},{key:"initMouse",value:function(t){this.onMouseDown=function(t){this.swiping=!0,this.start=t.clientX}.bind(this),this.onMouseUp=function(e){if(this.swiping){this.swiping=!1;var n=this.start-e.clientX;Math.abs(n)<10||(n<0?t.back():t.forward())}}.bind(this),t.canvas.addEventListener("mousedown",this.onMouseDown),t.canvas.addEventListener("mouseup",this.onMouseUp)}},{key:"initTouch",value:function(t){this.cancelSwipe=function(){this.swiping=!1}.bind(this),this.onTouchStart=function(t){this.cancelSwipeTimer=setTimeout(this.cancelSwipe,1e3),this.onMouseDown(t.targetTouches[0])}.bind(this),this.onTouchEnd=function(t){clearTimeout(this.cancelSwipeTimer),this.onMouseUp(t.changedTouches[0])}.bind(this),t.canvas.addEventListener("touchstart",this.onTouchStart),t.canvas.addEventListener("touchend",this.onTouchEnd)}},{key:"initKeyboad",value:function(t){var e=[33,"PageUp",37,"ArrowLeft"],n=[34,"PageDown",39,"ArrowRight"],r=[].concat(e,n);window.addEventListener("keydown",(function(t){(r.includes(t.keyCode)||r.includes(t.key))&&t.preventDefault()})),window.addEventListener("keyup",(function(r){return e.includes(r.keyCode)||e.includes(r.keyCode)?(r.preventDefault(),t.back()):n.includes(r.keyCode)||n.includes(r.key)?(r.preventDefault(),t.forward()):void 0}))}}],n&&wr(e.prototype,n),r&&wr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Or(t,e){return Or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Or(t,e)}function Sr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_r(t);if(e){var i=_r(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Cr(this,n)}}function Cr(t,e){if(e&&("object"===Pr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _r(t){return _r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_r(t)}var Tr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Or(t,e)}(o,t);var e,n,r,i=Sr(o);function o(t){var e,n=t.sketch,r=t.id;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,{sketch:n,id:r,type:Fn.types.WORKS})).video=e.domElement.getElementsByTagName("video")[0],e.video.pause(),e.text=e.domElement.getElementsByClassName("description")[0],e}return e=o,n&&kr(e.prototype,n),r&&kr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Fn);function jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Er=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=new An,this.canvas=this.background.sketchpad.canvas;var e=this.background,n=e.grid,r=e.navscan,i=e.rain,o=e.blockflow,s=e.ablaze,a=Fn.types,l=a.HOME,u=a.INTRO,c=a.INFO;this.screens=[new Fn({type:l,sketch:n,id:"home"}),new Fn({type:u,sketch:r,id:"navscan"}),new Fn({type:u,sketch:i,id:"rain"}),new Fn({type:u,sketch:o,id:"blockflow"}),new Fn({type:u,sketch:s,id:"ablaze"}),new Tr({sketch:n,id:"orion"}),new Tr({sketch:n,id:"vesuna"}),new Tr({sketch:n,id:"disintegrator"}),new Tr({sketch:n,id:"textformer"}),new Fn({type:c,sketch:n,id:"about"}),new Fn({type:c,sketch:n,id:"links"})],this.length=this.screens.length,this.index=0,this.currentScreen=this.screens[this.index],this.title=new cr,this.ui=new hr(this),this.animations=new br(this),this.controls=new xr(this),this.refresh()}var e,n,r;return e=t,(n=[{key:"load",value:function(){var t=window.location.hash.replace("#","");this.goto(t)}},{key:"back",value:function(){this.atStart||this.goto(this.index-1)}},{key:"forward",value:function(){this.atEnd||this.goto(this.index+1)}},{key:"goto",value:function(t){if("number"!=typeof t&&(t=this.indexOf(t)),t!==this.index){var e=this.currentScreen,n=this.screens[t],r=t<this.index;this.set(t),this.animations.tween(e,n,r)}}},{key:"set",value:function(t){this.index=t,this.currentScreen=this.screens[t],this.refresh(),window.location.hash=this.currentScreen.id}},{key:"refresh",value:function(){this.screens.forEach((function(t){t.type===Fn.types.INFO&&t.hide()})),this.screens[0].show(),this.currentScreen.show(),this.atStart=0===this.index,this.atEnd=this.index===this.length-1,this.ui.setArrows(this.atStart,this.atEnd)}},{key:"indexOf",value:function(t){for(var e=0;e<this.length;e++)if(this.screens[e].id===t)return e;return 0}}])&&jr(e.prototype,n),r&&jr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();!function(t){var e="?nojs";if(window.location.search!==e){var n=document.documentElement;try{n.classList.add("initing");var r=new Er;requestAnimationFrame((function(){r.load(),console.log(r),n.classList.remove("no-js"),n.classList.add("js")}))}catch(t){return console.error(t)}}}()})();